from torch.optim import Adam
from pykeen import predict
from pykeen.models import TransE
from pykeen.datasets import FB15k237, Nations
from pykeen.training import SLCWATrainingLoop
from pykeen.evaluation import RankBasedEvaluator

#Речиси исто со со аудиториската transe_examples.py само со друго множество, и печатење на метриките од евалуацијата
#според тоа со овој модел многу подобри резулататите ваде спреред задача 1 и 2
if __name__ == '__main__':
    dataset = FB15k237()

    model = TransE(triples_factory=dataset.training)
    optimizer = Adam(params=model.get_grad_params())
    trainer = SLCWATrainingLoop(model=model,
                                triples_factory=dataset.training,
                                optimizer=optimizer)
    trainer.train(triples_factory=dataset.training,
                  num_epochs=2,
                  batch_size=64)

    evaluator = RankBasedEvaluator()
    res = evaluator.evaluate(model=model,
                             mapped_triples=dataset.testing.mapped_triples,
                             batch_size=128,
                             additional_filter_triples=[dataset.training.mapped_triples,
                                                        dataset.validation.mapped_triples])

    hits1 = res.get_metric('hits_at_1')
    hits3 = res.get_metric('hits_at_3')
    hits10 = res.get_metric('hits_at_10')
    mrr = res.get_metric('mean_reciprocal_rank')
    print(f'hits@1: {hits1: .3f}, hits@3: {hits3: .3f}, hits@10: {hits10: .3f}, и MRR: {mrr: .3f}')

    """Output:
    You're trying to map triples with 30 entities and 0 relations that are not in the training set. These triples will be excluded from the mapping.
    In total 28 from 20466 triples were filtered out
    No random seed is specified. This may lead to non-reproducible results.
    Training epochs on cpu:   0%|          | 0/2 [00:00<?, ?epoch/s]
    Training batches on cpu:   0%|          | 0/4252 [00:00<?, ?batch/s]
    Training batches on cpu:   0%|          | 8/4252 [00:00<00:56, 74.97batch/s]
    Training batches on cpu:   0%|          | 18/4252 [00:00<00:50, 83.25batch/s]
    Training batches on cpu:   1%|          | 27/4252 [00:00<00:50, 83.38batch/s]
    Training batches on cpu:   1%|          | 36/4252 [00:00<00:50, 83.15batch/s]
    Training batches on cpu:   1%|          | 45/4252 [00:00<00:51, 81.94batch/s]
    Training batches on cpu:   1%|▏         | 54/4252 [00:00<00:51, 82.22batch/s]
    Training batches on cpu:   1%|▏         | 63/4252 [00:00<00:50, 82.16batch/s]
    Training batches on cpu:   2%|▏         | 72/4252 [00:00<00:50, 82.60batch/s]
    Training batches on cpu:   2%|▏         | 81/4252 [00:00<00:50, 82.90batch/s]
    Training batches on cpu:   2%|▏         | 90/4252 [00:01<00:49, 83.34batch/s]
    Training batches on cpu:   2%|▏         | 99/4252 [00:01<00:49, 83.40batch/s]
    Training batches on cpu:   3%|▎         | 108/4252 [00:01<00:49, 83.22batch/s]
    Training batches on cpu:   3%|▎         | 117/4252 [00:01<00:50, 81.94batch/s]
    Training batches on cpu:   3%|▎         | 126/4252 [00:01<00:50, 82.42batch/s]
    Training batches on cpu:   3%|▎         | 135/4252 [00:01<00:49, 82.76batch/s]
    Training batches on cpu:   3%|▎         | 144/4252 [00:01<00:50, 82.09batch/s]
    Training batches on cpu:   4%|▎         | 153/4252 [00:01<00:49, 82.75batch/s]
    Training batches on cpu:   4%|▍         | 162/4252 [00:01<00:49, 82.31batch/s]
    Training batches on cpu:   4%|▍         | 171/4252 [00:02<00:48, 83.60batch/s]
    Training batches on cpu:   4%|▍         | 180/4252 [00:02<00:48, 83.82batch/s]
    Training batches on cpu:   4%|▍         | 189/4252 [00:02<00:49, 82.82batch/s]
    Training batches on cpu:   5%|▍         | 198/4252 [00:02<00:48, 83.04batch/s]
    Training batches on cpu:   5%|▍         | 207/4252 [00:02<00:48, 83.42batch/s]
    Training batches on cpu:   5%|▌         | 216/4252 [00:02<00:47, 84.64batch/s]
    Training batches on cpu:   5%|▌         | 225/4252 [00:02<00:47, 84.07batch/s]
    Training batches on cpu:   6%|▌         | 234/4252 [00:02<00:48, 83.45batch/s]
    Training batches on cpu:   6%|▌         | 243/4252 [00:02<00:48, 83.02batch/s]
    Training batches on cpu:   6%|▌         | 252/4252 [00:03<00:47, 83.41batch/s]
    Training batches on cpu:   6%|▌         | 261/4252 [00:03<00:47, 83.23batch/s]
    Training batches on cpu:   6%|▋         | 270/4252 [00:03<00:46, 84.73batch/s]
    Training batches on cpu:   7%|▋         | 279/4252 [00:03<00:47, 83.44batch/s]
    Training batches on cpu:   7%|▋         | 288/4252 [00:03<00:47, 84.18batch/s]
    Training batches on cpu:   7%|▋         | 297/4252 [00:03<00:47, 83.76batch/s]
    Training batches on cpu:   7%|▋         | 306/4252 [00:03<00:47, 83.93batch/s]
    Training batches on cpu:   7%|▋         | 315/4252 [00:03<00:47, 83.35batch/s]
    Training batches on cpu:   8%|▊         | 324/4252 [00:03<00:47, 82.95batch/s]
    Training batches on cpu:   8%|▊         | 333/4252 [00:04<00:46, 83.83batch/s]
    Training batches on cpu:   8%|▊         | 342/4252 [00:04<00:46, 83.98batch/s]
    Training batches on cpu:   8%|▊         | 351/4252 [00:04<00:46, 84.56batch/s]
    Training batches on cpu:   8%|▊         | 360/4252 [00:04<00:45, 84.97batch/s]
    Training batches on cpu:   9%|▊         | 369/4252 [00:04<00:45, 84.54batch/s]
    Training batches on cpu:   9%|▉         | 378/4252 [00:04<00:45, 84.72batch/s]
    Training batches on cpu:   9%|▉         | 387/4252 [00:04<00:46, 83.90batch/s]
    Training batches on cpu:   9%|▉         | 396/4252 [00:04<00:46, 83.79batch/s]
    Training batches on cpu:  10%|▉         | 405/4252 [00:04<00:45, 83.96batch/s]
    Training batches on cpu:  10%|▉         | 414/4252 [00:04<00:45, 84.07batch/s]
    Training batches on cpu:  10%|▉         | 423/4252 [00:05<00:45, 83.45batch/s]
    Training batches on cpu:  10%|█         | 432/4252 [00:05<00:45, 84.66batch/s]
    Training batches on cpu:  10%|█         | 441/4252 [00:05<00:46, 82.25batch/s]
    Training batches on cpu:  11%|█         | 450/4252 [00:05<00:45, 82.86batch/s]
    Training batches on cpu:  11%|█         | 459/4252 [00:05<00:45, 82.61batch/s]
    Training batches on cpu:  11%|█         | 468/4252 [00:05<00:45, 83.59batch/s]
    Training batches on cpu:  11%|█         | 477/4252 [00:05<00:45, 83.58batch/s]
    Training batches on cpu:  11%|█▏        | 486/4252 [00:05<00:44, 83.80batch/s]
    Training batches on cpu:  12%|█▏        | 495/4252 [00:05<00:45, 83.27batch/s]
    Training batches on cpu:  12%|█▏        | 504/4252 [00:06<00:44, 83.58batch/s]
    Training batches on cpu:  12%|█▏        | 513/4252 [00:06<00:44, 83.58batch/s]
    Training batches on cpu:  12%|█▏        | 522/4252 [00:06<00:44, 83.11batch/s]
    Training batches on cpu:  12%|█▏        | 531/4252 [00:06<00:44, 83.47batch/s]
    Training batches on cpu:  13%|█▎        | 540/4252 [00:06<00:43, 84.44batch/s]
    Training batches on cpu:  13%|█▎        | 549/4252 [00:06<00:43, 84.17batch/s]
    Training batches on cpu:  13%|█▎        | 558/4252 [00:06<00:43, 85.66batch/s]
    Training batches on cpu:  13%|█▎        | 567/4252 [00:06<00:43, 84.78batch/s]
    Training batches on cpu:  14%|█▎        | 576/4252 [00:06<00:43, 84.64batch/s]
    Training batches on cpu:  14%|█▍        | 585/4252 [00:07<00:43, 83.61batch/s]
    Training batches on cpu:  14%|█▍        | 594/4252 [00:07<00:43, 83.83batch/s]
    Training batches on cpu:  14%|█▍        | 603/4252 [00:07<00:43, 83.05batch/s]
    Training batches on cpu:  14%|█▍        | 612/4252 [00:07<00:43, 84.13batch/s]
    Training batches on cpu:  15%|█▍        | 621/4252 [00:07<00:43, 84.43batch/s]
    Training batches on cpu:  15%|█▍        | 630/4252 [00:07<00:42, 85.85batch/s]
    Training batches on cpu:  15%|█▌        | 639/4252 [00:07<00:42, 84.55batch/s]
    Training batches on cpu:  15%|█▌        | 648/4252 [00:07<00:43, 83.78batch/s]
    Training batches on cpu:  15%|█▌        | 657/4252 [00:07<00:43, 83.48batch/s]
    Training batches on cpu:  16%|█▌        | 666/4252 [00:07<00:43, 81.69batch/s]
    Training batches on cpu:  16%|█▌        | 675/4252 [00:08<00:42, 83.61batch/s]
    Training batches on cpu:  16%|█▌        | 684/4252 [00:08<00:41, 85.01batch/s]
    Training batches on cpu:  16%|█▋        | 693/4252 [00:08<00:42, 82.94batch/s]
    Training batches on cpu:  17%|█▋        | 702/4252 [00:08<00:43, 81.99batch/s]
    Training batches on cpu:  17%|█▋        | 711/4252 [00:08<00:42, 83.14batch/s]
    Training batches on cpu:  17%|█▋        | 720/4252 [00:08<00:42, 83.03batch/s]
    Training batches on cpu:  17%|█▋        | 729/4252 [00:08<00:42, 83.19batch/s]
    Training batches on cpu:  17%|█▋        | 738/4252 [00:08<00:41, 84.23batch/s]
    Training batches on cpu:  18%|█▊        | 747/4252 [00:08<00:41, 83.56batch/s]
    Training batches on cpu:  18%|█▊        | 756/4252 [00:09<00:42, 82.42batch/s]
    Training batches on cpu:  18%|█▊        | 765/4252 [00:09<00:42, 81.85batch/s]
    Training batches on cpu:  18%|█▊        | 774/4252 [00:09<00:42, 82.36batch/s]
    Training batches on cpu:  18%|█▊        | 783/4252 [00:09<00:42, 82.04batch/s]
    Training batches on cpu:  19%|█▊        | 792/4252 [00:09<00:41, 82.71batch/s]
    Training batches on cpu:  19%|█▉        | 801/4252 [00:09<00:41, 82.74batch/s]
    Training batches on cpu:  19%|█▉        | 810/4252 [00:09<00:41, 83.21batch/s]
    Training batches on cpu:  19%|█▉        | 819/4252 [00:09<00:41, 81.95batch/s]
    Training batches on cpu:  19%|█▉        | 828/4252 [00:09<00:42, 80.01batch/s]
    Training batches on cpu:  20%|█▉        | 837/4252 [00:10<00:42, 79.97batch/s]
    Training batches on cpu:  20%|█▉        | 846/4252 [00:10<00:41, 81.89batch/s]
    Training batches on cpu:  20%|██        | 855/4252 [00:10<00:41, 82.16batch/s]
    Training batches on cpu:  20%|██        | 864/4252 [00:10<00:41, 81.90batch/s]
    Training batches on cpu:  21%|██        | 873/4252 [00:10<00:41, 81.50batch/s]
    Training batches on cpu:  21%|██        | 882/4252 [00:10<00:41, 80.78batch/s]
    Training batches on cpu:  21%|██        | 891/4252 [00:10<00:40, 82.04batch/s]
    Training batches on cpu:  21%|██        | 900/4252 [00:10<00:40, 82.94batch/s]
    Training batches on cpu:  21%|██▏       | 909/4252 [00:10<00:40, 82.44batch/s]
    Training batches on cpu:  22%|██▏       | 918/4252 [00:11<00:40, 82.32batch/s]
    Training batches on cpu:  22%|██▏       | 927/4252 [00:11<00:40, 81.57batch/s]
    Training batches on cpu:  22%|██▏       | 936/4252 [00:11<00:40, 81.71batch/s]
    Training batches on cpu:  22%|██▏       | 945/4252 [00:11<00:41, 80.28batch/s]
    Training batches on cpu:  22%|██▏       | 954/4252 [00:11<00:41, 79.73batch/s]
    Training batches on cpu:  23%|██▎       | 963/4252 [00:11<00:40, 80.62batch/s]
    Training batches on cpu:  23%|██▎       | 972/4252 [00:11<00:40, 80.61batch/s]
    Training batches on cpu:  23%|██▎       | 981/4252 [00:11<00:40, 80.81batch/s]
    Training batches on cpu:  23%|██▎       | 990/4252 [00:11<00:40, 80.52batch/s]
    Training batches on cpu:  23%|██▎       | 999/4252 [00:12<00:40, 80.32batch/s]
    Training batches on cpu:  24%|██▎       | 1008/4252 [00:12<00:40, 80.40batch/s]
    Training batches on cpu:  24%|██▍       | 1017/4252 [00:12<00:39, 81.10batch/s]
    Training batches on cpu:  24%|██▍       | 1026/4252 [00:12<00:39, 80.72batch/s]
    Training batches on cpu:  24%|██▍       | 1035/4252 [00:12<00:40, 80.25batch/s]
    Training batches on cpu:  25%|██▍       | 1044/4252 [00:12<00:40, 80.13batch/s]
    Training batches on cpu:  25%|██▍       | 1053/4252 [00:12<00:39, 80.48batch/s]
    Training batches on cpu:  25%|██▍       | 1062/4252 [00:12<00:38, 82.04batch/s]
    Training batches on cpu:  25%|██▌       | 1071/4252 [00:12<00:39, 80.94batch/s]
    Training batches on cpu:  25%|██▌       | 1080/4252 [00:13<00:39, 80.40batch/s]
    Training batches on cpu:  26%|██▌       | 1089/4252 [00:13<00:39, 79.81batch/s]
    Training batches on cpu:  26%|██▌       | 1097/4252 [00:13<00:39, 79.48batch/s]
    Training batches on cpu:  26%|██▌       | 1106/4252 [00:13<00:39, 80.03batch/s]
    Training batches on cpu:  26%|██▌       | 1115/4252 [00:13<00:38, 81.75batch/s]
    Training batches on cpu:  26%|██▋       | 1124/4252 [00:13<00:38, 81.39batch/s]
    Training batches on cpu:  27%|██▋       | 1133/4252 [00:13<00:38, 82.03batch/s]
    Training batches on cpu:  27%|██▋       | 1142/4252 [00:13<00:37, 82.48batch/s]
    Training batches on cpu:  27%|██▋       | 1151/4252 [00:13<00:37, 81.67batch/s]
    Training batches on cpu:  27%|██▋       | 1160/4252 [00:14<00:38, 80.04batch/s]
    Training batches on cpu:  27%|██▋       | 1169/4252 [00:14<00:38, 81.06batch/s]
    Training batches on cpu:  28%|██▊       | 1178/4252 [00:14<00:37, 81.35batch/s]
    Training batches on cpu:  28%|██▊       | 1187/4252 [00:14<00:37, 81.56batch/s]
    Training batches on cpu:  28%|██▊       | 1196/4252 [00:14<00:37, 80.61batch/s]
    Training batches on cpu:  28%|██▊       | 1205/4252 [00:14<00:37, 80.81batch/s]
    Training batches on cpu:  29%|██▊       | 1214/4252 [00:14<00:37, 81.18batch/s]
    Training batches on cpu:  29%|██▉       | 1223/4252 [00:14<00:37, 80.99batch/s]
    Training batches on cpu:  29%|██▉       | 1232/4252 [00:14<00:37, 81.08batch/s]
    Training batches on cpu:  29%|██▉       | 1241/4252 [00:15<00:36, 81.59batch/s]
    Training batches on cpu:  29%|██▉       | 1250/4252 [00:15<00:37, 80.63batch/s]
    Training batches on cpu:  30%|██▉       | 1259/4252 [00:15<00:37, 80.40batch/s]
    Training batches on cpu:  30%|██▉       | 1268/4252 [00:15<00:36, 81.10batch/s]
    Training batches on cpu:  30%|███       | 1277/4252 [00:15<00:36, 80.72batch/s]
    Training batches on cpu:  30%|███       | 1286/4252 [00:15<00:37, 79.61batch/s]
    Training batches on cpu:  30%|███       | 1294/4252 [00:15<00:37, 79.34batch/s]
    Training batches on cpu:  31%|███       | 1303/4252 [00:15<00:36, 79.71batch/s]
    Training batches on cpu:  31%|███       | 1312/4252 [00:15<00:36, 80.19batch/s]
    Training batches on cpu:  31%|███       | 1321/4252 [00:16<00:36, 80.96batch/s]
    Training batches on cpu:  31%|███▏      | 1330/4252 [00:16<00:35, 81.73batch/s]
    Training batches on cpu:  31%|███▏      | 1339/4252 [00:16<00:35, 81.38batch/s]
    Training batches on cpu:  32%|███▏      | 1348/4252 [00:16<00:35, 81.13batch/s]
    Training batches on cpu:  32%|███▏      | 1357/4252 [00:16<00:35, 81.18batch/s]
    Training batches on cpu:  32%|███▏      | 1366/4252 [00:16<00:35, 81.00batch/s]
    Training batches on cpu:  32%|███▏      | 1375/4252 [00:16<00:35, 80.44batch/s]
    Training batches on cpu:  33%|███▎      | 1384/4252 [00:16<00:35, 80.48batch/s]
    Training batches on cpu:  33%|███▎      | 1393/4252 [00:16<00:35, 80.51batch/s]
    Training batches on cpu:  33%|███▎      | 1402/4252 [00:17<00:35, 80.74batch/s]
    Training batches on cpu:  33%|███▎      | 1411/4252 [00:17<00:35, 80.47batch/s]
    Training batches on cpu:  33%|███▎      | 1420/4252 [00:17<00:35, 79.86batch/s]
    Training batches on cpu:  34%|███▎      | 1429/4252 [00:17<00:34, 80.72batch/s]
    Training batches on cpu:  34%|███▍      | 1438/4252 [00:17<00:35, 80.03batch/s]
    Training batches on cpu:  34%|███▍      | 1447/4252 [00:17<00:34, 81.28batch/s]
    Training batches on cpu:  34%|███▍      | 1456/4252 [00:17<00:34, 81.28batch/s]
    Training batches on cpu:  34%|███▍      | 1465/4252 [00:17<00:34, 80.42batch/s]
    Training batches on cpu:  35%|███▍      | 1474/4252 [00:17<00:35, 78.99batch/s]
    Training batches on cpu:  35%|███▍      | 1482/4252 [00:18<00:35, 78.89batch/s]
    Training batches on cpu:  35%|███▌      | 1491/4252 [00:18<00:34, 80.71batch/s]
    Training batches on cpu:  35%|███▌      | 1500/4252 [00:18<00:34, 80.89batch/s]
    Training batches on cpu:  35%|███▌      | 1509/4252 [00:18<00:33, 82.13batch/s]
    Training batches on cpu:  36%|███▌      | 1518/4252 [00:18<00:33, 81.43batch/s]
    Training batches on cpu:  36%|███▌      | 1527/4252 [00:18<00:33, 81.39batch/s]
    Training batches on cpu:  36%|███▌      | 1536/4252 [00:18<00:33, 81.36batch/s]
    Training batches on cpu:  36%|███▋      | 1545/4252 [00:18<00:33, 81.79batch/s]
    Training batches on cpu:  37%|███▋      | 1554/4252 [00:18<00:33, 80.33batch/s]
    Training batches on cpu:  37%|███▋      | 1563/4252 [00:19<00:33, 81.27batch/s]
    Training batches on cpu:  37%|███▋      | 1572/4252 [00:19<00:33, 80.19batch/s]
    Training batches on cpu:  37%|███▋      | 1581/4252 [00:19<00:33, 80.52batch/s]
    Training batches on cpu:  37%|███▋      | 1590/4252 [00:19<00:32, 80.75batch/s]
    Training batches on cpu:  38%|███▊      | 1599/4252 [00:19<00:33, 80.05batch/s]
    Training batches on cpu:  38%|███▊      | 1608/4252 [00:19<00:33, 80.00batch/s]
    Training batches on cpu:  38%|███▊      | 1617/4252 [00:19<00:32, 80.17batch/s]
    Training batches on cpu:  38%|███▊      | 1626/4252 [00:19<00:32, 79.86batch/s]
    Training batches on cpu:  38%|███▊      | 1634/4252 [00:19<00:33, 79.30batch/s]
    Training batches on cpu:  39%|███▊      | 1643/4252 [00:20<00:32, 79.91batch/s]
    Training batches on cpu:  39%|███▉      | 1652/4252 [00:20<00:32, 79.46batch/s]
    Training batches on cpu:  39%|███▉      | 1660/4252 [00:20<00:32, 79.01batch/s]
    Training batches on cpu:  39%|███▉      | 1669/4252 [00:20<00:32, 80.15batch/s]
    Training batches on cpu:  39%|███▉      | 1678/4252 [00:20<00:32, 79.62batch/s]
    Training batches on cpu:  40%|███▉      | 1687/4252 [00:20<00:32, 80.13batch/s]
    Training batches on cpu:  40%|███▉      | 1696/4252 [00:20<00:31, 80.48batch/s]
    Training batches on cpu:  40%|████      | 1705/4252 [00:20<00:31, 80.08batch/s]
    Training batches on cpu:  40%|████      | 1714/4252 [00:20<00:31, 80.01batch/s]
    Training batches on cpu:  41%|████      | 1723/4252 [00:21<00:31, 79.54batch/s]
    Training batches on cpu:  41%|████      | 1731/4252 [00:21<00:32, 78.64batch/s]
    Training batches on cpu:  41%|████      | 1739/4252 [00:21<00:32, 78.43batch/s]
    Training batches on cpu:  41%|████      | 1747/4252 [00:21<00:31, 78.49batch/s]
    Training batches on cpu:  41%|████▏     | 1756/4252 [00:21<00:31, 79.58batch/s]
    Training batches on cpu:  41%|████▏     | 1764/4252 [00:21<00:31, 79.53batch/s]
    Training batches on cpu:  42%|████▏     | 1773/4252 [00:21<00:30, 80.99batch/s]
    Training batches on cpu:  42%|████▏     | 1782/4252 [00:21<00:30, 79.75batch/s]
    Training batches on cpu:  42%|████▏     | 1790/4252 [00:21<00:31, 79.21batch/s]
    Training batches on cpu:  42%|████▏     | 1798/4252 [00:21<00:31, 78.60batch/s]
    Training batches on cpu:  42%|████▏     | 1807/4252 [00:22<00:30, 79.21batch/s]
    Training batches on cpu:  43%|████▎     | 1815/4252 [00:22<00:31, 78.38batch/s]
    Training batches on cpu:  43%|████▎     | 1824/4252 [00:22<00:30, 79.50batch/s]
    Training batches on cpu:  43%|████▎     | 1832/4252 [00:22<00:31, 77.50batch/s]
    Training batches on cpu:  43%|████▎     | 1841/4252 [00:22<00:30, 78.44batch/s]
    Training batches on cpu:  44%|████▎     | 1850/4252 [00:22<00:30, 79.31batch/s]
    Training batches on cpu:  44%|████▎     | 1859/4252 [00:22<00:29, 79.91batch/s]
    Training batches on cpu:  44%|████▍     | 1867/4252 [00:22<00:29, 79.77batch/s]
    Training batches on cpu:  44%|████▍     | 1875/4252 [00:22<00:30, 79.22batch/s]
    Training batches on cpu:  44%|████▍     | 1883/4252 [00:23<00:30, 78.16batch/s]
    Training batches on cpu:  44%|████▍     | 1891/4252 [00:23<00:30, 78.30batch/s]
    Training batches on cpu:  45%|████▍     | 1899/4252 [00:23<00:29, 78.63batch/s]
    Training batches on cpu:  45%|████▍     | 1907/4252 [00:23<00:29, 78.40batch/s]
    Training batches on cpu:  45%|████▌     | 1915/4252 [00:23<00:30, 77.13batch/s]
    Training batches on cpu:  45%|████▌     | 1924/4252 [00:23<00:29, 78.21batch/s]
    Training batches on cpu:  45%|████▌     | 1933/4252 [00:23<00:29, 79.38batch/s]
    Training batches on cpu:  46%|████▌     | 1942/4252 [00:23<00:28, 79.75batch/s]
    Training batches on cpu:  46%|████▌     | 1950/4252 [00:23<00:29, 78.99batch/s]
    Training batches on cpu:  46%|████▌     | 1958/4252 [00:24<00:29, 78.44batch/s]
    Training batches on cpu:  46%|████▌     | 1966/4252 [00:24<00:29, 78.73batch/s]
    Training batches on cpu:  46%|████▋     | 1975/4252 [00:24<00:28, 80.66batch/s]
    Training batches on cpu:  47%|████▋     | 1984/4252 [00:24<00:28, 79.30batch/s]
    Training batches on cpu:  47%|████▋     | 1992/4252 [00:24<00:28, 78.02batch/s]
    Training batches on cpu:  47%|████▋     | 2001/4252 [00:24<00:28, 79.24batch/s]
    Training batches on cpu:  47%|████▋     | 2009/4252 [00:24<00:28, 79.29batch/s]
    Training batches on cpu:  47%|████▋     | 2017/4252 [00:24<00:28, 78.43batch/s]
    Training batches on cpu:  48%|████▊     | 2025/4252 [00:24<00:28, 78.49batch/s]
    Training batches on cpu:  48%|████▊     | 2033/4252 [00:24<00:28, 78.31batch/s]
    Training batches on cpu:  48%|████▊     | 2041/4252 [00:25<00:28, 78.63batch/s]
    Training batches on cpu:  48%|████▊     | 2049/4252 [00:25<00:28, 77.29batch/s]
    Training batches on cpu:  48%|████▊     | 2057/4252 [00:25<00:28, 77.68batch/s]
    Training batches on cpu:  49%|████▊     | 2065/4252 [00:25<00:28, 77.97batch/s]
    Training batches on cpu:  49%|████▉     | 2073/4252 [00:25<00:27, 78.17batch/s]
    Training batches on cpu:  49%|████▉     | 2081/4252 [00:25<00:27, 78.31batch/s]
    Training batches on cpu:  49%|████▉     | 2089/4252 [00:25<00:27, 78.18batch/s]
    Training batches on cpu:  49%|████▉     | 2097/4252 [00:25<00:27, 78.32batch/s]
    Training batches on cpu:  50%|████▉     | 2105/4252 [00:25<00:27, 77.96batch/s]
    Training batches on cpu:  50%|████▉     | 2113/4252 [00:25<00:27, 78.39batch/s]
    Training batches on cpu:  50%|████▉     | 2121/4252 [00:26<00:27, 77.78batch/s]
    Training batches on cpu:  50%|█████     | 2130/4252 [00:26<00:26, 79.34batch/s]
    Training batches on cpu:  50%|█████     | 2139/4252 [00:26<00:26, 80.63batch/s]
    Training batches on cpu:  51%|█████     | 2148/4252 [00:26<00:26, 80.17batch/s]
    Training batches on cpu:  51%|█████     | 2157/4252 [00:26<00:26, 79.85batch/s]
    Training batches on cpu:  51%|█████     | 2165/4252 [00:26<00:26, 79.73batch/s]
    Training batches on cpu:  51%|█████     | 2173/4252 [00:26<00:26, 78.97batch/s]
    Training batches on cpu:  51%|█████▏    | 2181/4252 [00:26<00:26, 78.65batch/s]
    Training batches on cpu:  52%|█████▏    | 2190/4252 [00:26<00:26, 79.25batch/s]
    Training batches on cpu:  52%|█████▏    | 2198/4252 [00:27<00:25, 79.30batch/s]
    Training batches on cpu:  52%|█████▏    | 2207/4252 [00:27<00:25, 79.92batch/s]
    Training batches on cpu:  52%|█████▏    | 2216/4252 [00:27<00:25, 78.82batch/s]
    Training batches on cpu:  52%|█████▏    | 2224/4252 [00:27<00:26, 77.90batch/s]
    Training batches on cpu:  52%|█████▏    | 2232/4252 [00:27<00:25, 78.33batch/s]
    Training batches on cpu:  53%|█████▎    | 2240/4252 [00:27<00:26, 77.32batch/s]
    Training batches on cpu:  53%|█████▎    | 2248/4252 [00:27<00:25, 77.70batch/s]
    Training batches on cpu:  53%|█████▎    | 2257/4252 [00:27<00:25, 78.82batch/s]
    Training batches on cpu:  53%|█████▎    | 2266/4252 [00:27<00:24, 79.80batch/s]
    Training batches on cpu:  53%|█████▎    | 2274/4252 [00:28<00:25, 78.80batch/s]
    Training batches on cpu:  54%|█████▎    | 2283/4252 [00:28<00:24, 79.79batch/s]
    Training batches on cpu:  54%|█████▍    | 2291/4252 [00:28<00:25, 78.13batch/s]
    Training batches on cpu:  54%|█████▍    | 2300/4252 [00:28<00:24, 78.45batch/s]
    Training batches on cpu:  54%|█████▍    | 2309/4252 [00:28<00:24, 79.31batch/s]
    Training batches on cpu:  55%|█████▍    | 2318/4252 [00:28<00:24, 79.27batch/s]
    Training batches on cpu:  55%|█████▍    | 2327/4252 [00:28<00:24, 79.66batch/s]
    Training batches on cpu:  55%|█████▍    | 2336/4252 [00:28<00:23, 80.15batch/s]
    Training batches on cpu:  55%|█████▌    | 2345/4252 [00:28<00:23, 79.85batch/s]
    Training batches on cpu:  55%|█████▌    | 2353/4252 [00:29<00:23, 79.73batch/s]
    Training batches on cpu:  56%|█████▌    | 2361/4252 [00:29<00:23, 79.19batch/s]
    Training batches on cpu:  56%|█████▌    | 2369/4252 [00:29<00:23, 79.26batch/s]
    Training batches on cpu:  56%|█████▌    | 2377/4252 [00:29<00:23, 78.85batch/s]
    Training batches on cpu:  56%|█████▌    | 2386/4252 [00:29<00:23, 79.39batch/s]
    Training batches on cpu:  56%|█████▋    | 2395/4252 [00:29<00:23, 79.76batch/s]
    Training batches on cpu:  57%|█████▋    | 2404/4252 [00:29<00:23, 79.79batch/s]
    Training batches on cpu:  57%|█████▋    | 2413/4252 [00:29<00:22, 80.25batch/s]
    Training batches on cpu:  57%|█████▋    | 2422/4252 [00:29<00:23, 79.27batch/s]
    Training batches on cpu:  57%|█████▋    | 2430/4252 [00:29<00:22, 79.31batch/s]
    Training batches on cpu:  57%|█████▋    | 2439/4252 [00:30<00:22, 79.92batch/s]
    Training batches on cpu:  58%|█████▊    | 2447/4252 [00:30<00:23, 77.60batch/s]
    Training batches on cpu:  58%|█████▊    | 2455/4252 [00:30<00:23, 78.11batch/s]
    Training batches on cpu:  58%|█████▊    | 2463/4252 [00:30<00:22, 78.04batch/s]
    Training batches on cpu:  58%|█████▊    | 2471/4252 [00:30<00:22, 78.00batch/s]
    Training batches on cpu:  58%|█████▊    | 2479/4252 [00:30<00:22, 77.96batch/s]
    Training batches on cpu:  59%|█████▊    | 2488/4252 [00:30<00:22, 78.78batch/s]
    Training batches on cpu:  59%|█████▊    | 2496/4252 [00:30<00:22, 78.30batch/s]
    Training batches on cpu:  59%|█████▉    | 2504/4252 [00:30<00:22, 77.51batch/s]
    Training batches on cpu:  59%|█████▉    | 2512/4252 [00:31<00:22, 76.10batch/s]
    Training batches on cpu:  59%|█████▉    | 2520/4252 [00:31<00:22, 75.55batch/s]
    Training batches on cpu:  59%|█████▉    | 2528/4252 [00:31<00:23, 74.13batch/s]
    Training batches on cpu:  60%|█████▉    | 2536/4252 [00:31<00:23, 72.96batch/s]
    Training batches on cpu:  60%|█████▉    | 2544/4252 [00:31<00:23, 72.95batch/s]
    Training batches on cpu:  60%|██████    | 2552/4252 [00:31<00:22, 74.57batch/s]
    Training batches on cpu:  60%|██████    | 2560/4252 [00:31<00:22, 75.10batch/s]
    Training batches on cpu:  60%|██████    | 2569/4252 [00:31<00:21, 77.01batch/s]
    Training batches on cpu:  61%|██████    | 2577/4252 [00:31<00:21, 76.83batch/s]
    Training batches on cpu:  61%|██████    | 2586/4252 [00:32<00:21, 78.20batch/s]
    Training batches on cpu:  61%|██████    | 2594/4252 [00:32<00:21, 77.67batch/s]
    Training batches on cpu:  61%|██████    | 2603/4252 [00:32<00:20, 78.57batch/s]
    Training batches on cpu:  61%|██████▏   | 2611/4252 [00:32<00:20, 78.37batch/s]
    Training batches on cpu:  62%|██████▏   | 2620/4252 [00:32<00:20, 79.27batch/s]
    Training batches on cpu:  62%|██████▏   | 2629/4252 [00:32<00:20, 80.11batch/s]
    Training batches on cpu:  62%|██████▏   | 2638/4252 [00:32<00:20, 79.17batch/s]
    Training batches on cpu:  62%|██████▏   | 2646/4252 [00:32<00:20, 78.80batch/s]
    Training batches on cpu:  62%|██████▏   | 2654/4252 [00:32<00:20, 78.76batch/s]
    Training batches on cpu:  63%|██████▎   | 2662/4252 [00:32<00:20, 77.40batch/s]
    Training batches on cpu:  63%|██████▎   | 2671/4252 [00:33<00:20, 77.74batch/s]
    Training batches on cpu:  63%|██████▎   | 2679/4252 [00:33<00:20, 76.50batch/s]
    Training batches on cpu:  63%|██████▎   | 2687/4252 [00:33<00:20, 76.26batch/s]
    Training batches on cpu:  63%|██████▎   | 2695/4252 [00:33<00:20, 75.04batch/s]
    Training batches on cpu:  64%|██████▎   | 2703/4252 [00:33<00:20, 75.22batch/s]
    Training batches on cpu:  64%|██████▍   | 2711/4252 [00:33<00:20, 76.21batch/s]
    Training batches on cpu:  64%|██████▍   | 2720/4252 [00:33<00:19, 77.78batch/s]
    Training batches on cpu:  64%|██████▍   | 2728/4252 [00:33<00:19, 77.81batch/s]
    Training batches on cpu:  64%|██████▍   | 2736/4252 [00:33<00:19, 77.17batch/s]
    Training batches on cpu:  65%|██████▍   | 2744/4252 [00:34<00:19, 77.38batch/s]
    Training batches on cpu:  65%|██████▍   | 2752/4252 [00:34<00:19, 77.53batch/s]
    Training batches on cpu:  65%|██████▍   | 2760/4252 [00:34<00:19, 76.53batch/s]
    Training batches on cpu:  65%|██████▌   | 2768/4252 [00:34<00:19, 76.71batch/s]
    Training batches on cpu:  65%|██████▌   | 2776/4252 [00:34<00:19, 77.05batch/s]
    Training batches on cpu:  65%|██████▌   | 2785/4252 [00:34<00:18, 77.94batch/s]
    Training batches on cpu:  66%|██████▌   | 2793/4252 [00:34<00:19, 76.19batch/s]
    Training batches on cpu:  66%|██████▌   | 2801/4252 [00:34<00:19, 75.41batch/s]
    Training batches on cpu:  66%|██████▌   | 2809/4252 [00:34<00:19, 74.66batch/s]
    Training batches on cpu:  66%|██████▋   | 2817/4252 [00:35<00:19, 75.16batch/s]
    Training batches on cpu:  66%|██████▋   | 2825/4252 [00:35<00:19, 74.48batch/s]
    Training batches on cpu:  67%|██████▋   | 2833/4252 [00:35<00:19, 74.21batch/s]
    Training batches on cpu:  67%|██████▋   | 2841/4252 [00:35<00:19, 74.03batch/s]
    Training batches on cpu:  67%|██████▋   | 2849/4252 [00:35<00:19, 73.49batch/s]
    Training batches on cpu:  67%|██████▋   | 2857/4252 [00:35<00:18, 73.52batch/s]
    Training batches on cpu:  67%|██████▋   | 2865/4252 [00:35<00:18, 74.77batch/s]
    Training batches on cpu:  68%|██████▊   | 2873/4252 [00:35<00:18, 74.83batch/s]
    Training batches on cpu:  68%|██████▊   | 2882/4252 [00:35<00:17, 76.19batch/s]
    Training batches on cpu:  68%|██████▊   | 2891/4252 [00:36<00:17, 78.38batch/s]
    Training batches on cpu:  68%|██████▊   | 2900/4252 [00:36<00:17, 78.83batch/s]
    Training batches on cpu:  68%|██████▊   | 2908/4252 [00:36<00:17, 78.13batch/s]
    Training batches on cpu:  69%|██████▊   | 2916/4252 [00:36<00:17, 77.84batch/s]
    Training batches on cpu:  69%|██████▉   | 2924/4252 [00:36<00:17, 77.85batch/s]
    Training batches on cpu:  69%|██████▉   | 2932/4252 [00:36<00:17, 77.42batch/s]
    Training batches on cpu:  69%|██████▉   | 2940/4252 [00:36<00:16, 77.55batch/s]
    Training batches on cpu:  69%|██████▉   | 2949/4252 [00:36<00:16, 78.72batch/s]
    Training batches on cpu:  70%|██████▉   | 2957/4252 [00:36<00:16, 78.92batch/s]
    Training batches on cpu:  70%|██████▉   | 2966/4252 [00:36<00:16, 79.22batch/s]
    Training batches on cpu:  70%|██████▉   | 2974/4252 [00:37<00:16, 78.83batch/s]
    Training batches on cpu:  70%|███████   | 2983/4252 [00:37<00:16, 79.15batch/s]
    Training batches on cpu:  70%|███████   | 2991/4252 [00:37<00:16, 77.69batch/s]
    Training batches on cpu:  71%|███████   | 2999/4252 [00:37<00:16, 78.18batch/s]
    Training batches on cpu:  71%|███████   | 3007/4252 [00:37<00:16, 77.43batch/s]
    Training batches on cpu:  71%|███████   | 3015/4252 [00:37<00:15, 77.34batch/s]
    Training batches on cpu:  71%|███████   | 3023/4252 [00:37<00:16, 76.40batch/s]
    Training batches on cpu:  71%|███████▏  | 3032/4252 [00:37<00:15, 77.92batch/s]
    Training batches on cpu:  72%|███████▏  | 3041/4252 [00:37<00:15, 78.52batch/s]
    Training batches on cpu:  72%|███████▏  | 3049/4252 [00:38<00:15, 77.90batch/s]
    Training batches on cpu:  72%|███████▏  | 3057/4252 [00:38<00:15, 78.34batch/s]
    Training batches on cpu:  72%|███████▏  | 3065/4252 [00:38<00:15, 78.42batch/s]
    Training batches on cpu:  72%|███████▏  | 3073/4252 [00:38<00:15, 78.04batch/s]
    Training batches on cpu:  72%|███████▏  | 3081/4252 [00:38<00:14, 78.44batch/s]
    Training batches on cpu:  73%|███████▎  | 3089/4252 [00:38<00:15, 75.85batch/s]
    Training batches on cpu:  73%|███████▎  | 3097/4252 [00:38<00:15, 75.16batch/s]
    Training batches on cpu:  73%|███████▎  | 3105/4252 [00:38<00:15, 75.74batch/s]
    Training batches on cpu:  73%|███████▎  | 3113/4252 [00:38<00:14, 76.59batch/s]
    Training batches on cpu:  73%|███████▎  | 3121/4252 [00:38<00:14, 76.75batch/s]
    Training batches on cpu:  74%|███████▎  | 3129/4252 [00:39<00:14, 77.53batch/s]
    Training batches on cpu:  74%|███████▍  | 3137/4252 [00:39<00:14, 76.30batch/s]
    Training batches on cpu:  74%|███████▍  | 3145/4252 [00:39<00:14, 76.11batch/s]
    Training batches on cpu:  74%|███████▍  | 3153/4252 [00:39<00:14, 76.20batch/s]
    Training batches on cpu:  74%|███████▍  | 3162/4252 [00:39<00:14, 77.57batch/s]
    Training batches on cpu:  75%|███████▍  | 3170/4252 [00:39<00:14, 76.79batch/s]
    Training batches on cpu:  75%|███████▍  | 3179/4252 [00:39<00:13, 77.53batch/s]
    Training batches on cpu:  75%|███████▍  | 3188/4252 [00:39<00:13, 78.67batch/s]
    Training batches on cpu:  75%|███████▌  | 3196/4252 [00:39<00:13, 77.80batch/s]
    Training batches on cpu:  75%|███████▌  | 3204/4252 [00:40<00:13, 76.96batch/s]
    Training batches on cpu:  76%|███████▌  | 3213/4252 [00:40<00:13, 77.85batch/s]
    Training batches on cpu:  76%|███████▌  | 3221/4252 [00:40<00:13, 76.79batch/s]
    Training batches on cpu:  76%|███████▌  | 3229/4252 [00:40<00:13, 76.25batch/s]
    Training batches on cpu:  76%|███████▌  | 3237/4252 [00:40<00:13, 76.51batch/s]
    Training batches on cpu:  76%|███████▋  | 3245/4252 [00:40<00:13, 77.12batch/s]
    Training batches on cpu:  77%|███████▋  | 3253/4252 [00:40<00:13, 76.04batch/s]
    Training batches on cpu:  77%|███████▋  | 3261/4252 [00:40<00:12, 76.80batch/s]
    Training batches on cpu:  77%|███████▋  | 3269/4252 [00:40<00:12, 76.90batch/s]
    Training batches on cpu:  77%|███████▋  | 3278/4252 [00:40<00:12, 78.05batch/s]
    Training batches on cpu:  77%|███████▋  | 3287/4252 [00:41<00:12, 79.27batch/s]
    Training batches on cpu:  78%|███████▊  | 3296/4252 [00:41<00:11, 79.89batch/s]
    Training batches on cpu:  78%|███████▊  | 3304/4252 [00:41<00:11, 79.76batch/s]
    Training batches on cpu:  78%|███████▊  | 3312/4252 [00:41<00:11, 78.98batch/s]
    Training batches on cpu:  78%|███████▊  | 3320/4252 [00:41<00:11, 78.21batch/s]
    Training batches on cpu:  78%|███████▊  | 3328/4252 [00:41<00:11, 77.89batch/s]
    Training batches on cpu:  78%|███████▊  | 3336/4252 [00:41<00:11, 77.00batch/s]
    Training batches on cpu:  79%|███████▊  | 3345/4252 [00:41<00:11, 77.68batch/s]
    Training batches on cpu:  79%|███████▉  | 3353/4252 [00:41<00:11, 77.96batch/s]
    Training batches on cpu:  79%|███████▉  | 3362/4252 [00:42<00:11, 78.99batch/s]
    Training batches on cpu:  79%|███████▉  | 3370/4252 [00:42<00:11, 77.36batch/s]
    Training batches on cpu:  79%|███████▉  | 3378/4252 [00:42<00:11, 76.43batch/s]
    Training batches on cpu:  80%|███████▉  | 3386/4252 [00:42<00:11, 75.57batch/s]
    Training batches on cpu:  80%|███████▉  | 3394/4252 [00:42<00:11, 75.39batch/s]
    Training batches on cpu:  80%|████████  | 3402/4252 [00:42<00:11, 75.48batch/s]
    Training batches on cpu:  80%|████████  | 3410/4252 [00:42<00:10, 76.61batch/s]
    Training batches on cpu:  80%|████████  | 3418/4252 [00:42<00:10, 76.11batch/s]
    Training batches on cpu:  81%|████████  | 3426/4252 [00:42<00:10, 76.85batch/s]
    Training batches on cpu:  81%|████████  | 3434/4252 [00:43<00:10, 76.06batch/s]
    Training batches on cpu:  81%|████████  | 3443/4252 [00:43<00:10, 76.83batch/s]
    Training batches on cpu:  81%|████████  | 3451/4252 [00:43<00:10, 76.49batch/s]
    Training batches on cpu:  81%|████████▏ | 3459/4252 [00:43<00:10, 76.03batch/s]
    Training batches on cpu:  82%|████████▏ | 3468/4252 [00:43<00:10, 77.86batch/s]
    Training batches on cpu:  82%|████████▏ | 3477/4252 [00:43<00:09, 78.27batch/s]
    Training batches on cpu:  82%|████████▏ | 3485/4252 [00:43<00:09, 77.51batch/s]
    Training batches on cpu:  82%|████████▏ | 3493/4252 [00:43<00:09, 77.40batch/s]
    Training batches on cpu:  82%|████████▏ | 3501/4252 [00:43<00:09, 75.61batch/s]
    Training batches on cpu:  83%|████████▎ | 3509/4252 [00:43<00:09, 76.05batch/s]
    Training batches on cpu:  83%|████████▎ | 3517/4252 [00:44<00:09, 76.37batch/s]
    Training batches on cpu:  83%|████████▎ | 3526/4252 [00:44<00:09, 77.89batch/s]
    Training batches on cpu:  83%|████████▎ | 3534/4252 [00:44<00:09, 77.45batch/s]
    Training batches on cpu:  83%|████████▎ | 3542/4252 [00:44<00:09, 77.58batch/s]
    Training batches on cpu:  83%|████████▎ | 3550/4252 [00:44<00:09, 76.14batch/s]
    Training batches on cpu:  84%|████████▎ | 3558/4252 [00:44<00:09, 76.22batch/s]
    Training batches on cpu:  84%|████████▍ | 3566/4252 [00:44<00:09, 74.99batch/s]
    Training batches on cpu:  84%|████████▍ | 3574/4252 [00:44<00:08, 75.41batch/s]
    Training batches on cpu:  84%|████████▍ | 3582/4252 [00:44<00:08, 76.13batch/s]
    Training batches on cpu:  84%|████████▍ | 3590/4252 [00:45<00:09, 70.04batch/s]
    Training batches on cpu:  85%|████████▍ | 3599/4252 [00:45<00:08, 73.14batch/s]
    Training batches on cpu:  85%|████████▍ | 3608/4252 [00:45<00:08, 75.74batch/s]
    Training batches on cpu:  85%|████████▌ | 3616/4252 [00:45<00:08, 76.55batch/s]
    Training batches on cpu:  85%|████████▌ | 3624/4252 [00:45<00:09, 67.36batch/s]
    Training batches on cpu:  85%|████████▌ | 3632/4252 [00:45<00:09, 68.73batch/s]
    Training batches on cpu:  86%|████████▌ | 3640/4252 [00:45<00:08, 69.91batch/s]
    Training batches on cpu:  86%|████████▌ | 3648/4252 [00:45<00:08, 71.72batch/s]
    Training batches on cpu:  86%|████████▌ | 3656/4252 [00:45<00:08, 73.65batch/s]
    Training batches on cpu:  86%|████████▌ | 3664/4252 [00:46<00:07, 75.07batch/s]
    Training batches on cpu:  86%|████████▋ | 3672/4252 [00:46<00:07, 76.32batch/s]
    Training batches on cpu:  87%|████████▋ | 3680/4252 [00:46<00:07, 77.00batch/s]
    Training batches on cpu:  87%|████████▋ | 3688/4252 [00:46<00:07, 76.60batch/s]
    Training batches on cpu:  87%|████████▋ | 3696/4252 [00:46<00:07, 76.54batch/s]
    Training batches on cpu:  87%|████████▋ | 3704/4252 [00:46<00:07, 76.06batch/s]
    Training batches on cpu:  87%|████████▋ | 3712/4252 [00:46<00:07, 75.94batch/s]
    Training batches on cpu:  88%|████████▊ | 3721/4252 [00:46<00:06, 76.75batch/s]
    Training batches on cpu:  88%|████████▊ | 3729/4252 [00:46<00:06, 75.80batch/s]
    Training batches on cpu:  88%|████████▊ | 3737/4252 [00:47<00:06, 75.13batch/s]
    Training batches on cpu:  88%|████████▊ | 3745/4252 [00:47<00:06, 75.71batch/s]
    Training batches on cpu:  88%|████████▊ | 3754/4252 [00:47<00:06, 76.79batch/s]
    Training batches on cpu:  88%|████████▊ | 3762/4252 [00:47<00:06, 76.25batch/s]
    Training batches on cpu:  89%|████████▊ | 3770/4252 [00:47<00:06, 75.66batch/s]
    Training batches on cpu:  89%|████████▉ | 3778/4252 [00:47<00:06, 76.09batch/s]
    Training batches on cpu:  89%|████████▉ | 3786/4252 [00:47<00:06, 76.39batch/s]
    Training batches on cpu:  89%|████████▉ | 3794/4252 [00:47<00:05, 77.27batch/s]
    Training batches on cpu:  89%|████████▉ | 3802/4252 [00:47<00:05, 77.67batch/s]
    Training batches on cpu:  90%|████████▉ | 3810/4252 [00:47<00:05, 77.06batch/s]
    Training batches on cpu:  90%|████████▉ | 3818/4252 [00:48<00:05, 77.31batch/s]
    Training batches on cpu:  90%|████████▉ | 3826/4252 [00:48<00:05, 76.37batch/s]
    Training batches on cpu:  90%|█████████ | 3834/4252 [00:48<00:05, 76.60batch/s]
    Training batches on cpu:  90%|█████████ | 3842/4252 [00:48<00:05, 76.76batch/s]
    Training batches on cpu:  91%|█████████ | 3851/4252 [00:48<00:05, 77.52batch/s]
    Training batches on cpu:  91%|█████████ | 3859/4252 [00:48<00:05, 77.19batch/s]
    Training batches on cpu:  91%|█████████ | 3868/4252 [00:48<00:04, 77.81batch/s]
    Training batches on cpu:  91%|█████████ | 3876/4252 [00:48<00:04, 76.54batch/s]
    Training batches on cpu:  91%|█████████▏| 3884/4252 [00:48<00:04, 76.50batch/s]
    Training batches on cpu:  92%|█████████▏| 3892/4252 [00:49<00:04, 77.12batch/s]
    Training batches on cpu:  92%|█████████▏| 3901/4252 [00:49<00:04, 78.63batch/s]
    Training batches on cpu:  92%|█████████▏| 3910/4252 [00:49<00:04, 79.45batch/s]
    Training batches on cpu:  92%|█████████▏| 3919/4252 [00:49<00:04, 79.36batch/s]
    Training batches on cpu:  92%|█████████▏| 3927/4252 [00:49<00:04, 78.28batch/s]
    Training batches on cpu:  93%|█████████▎| 3936/4252 [00:49<00:04, 78.55batch/s]
    Training batches on cpu:  93%|█████████▎| 3944/4252 [00:49<00:03, 77.93batch/s]
    Training batches on cpu:  93%|█████████▎| 3952/4252 [00:49<00:03, 77.26batch/s]
    Training batches on cpu:  93%|█████████▎| 3960/4252 [00:49<00:03, 76.37batch/s]
    Training batches on cpu:  93%|█████████▎| 3968/4252 [00:50<00:03, 76.16batch/s]
    Training batches on cpu:  94%|█████████▎| 3976/4252 [00:50<00:03, 76.02batch/s]
    Training batches on cpu:  94%|█████████▎| 3984/4252 [00:50<00:03, 75.70batch/s]
    Training batches on cpu:  94%|█████████▍| 3992/4252 [00:50<00:03, 74.64batch/s]
    Training batches on cpu:  94%|█████████▍| 4000/4252 [00:50<00:03, 74.74batch/s]
    Training batches on cpu:  94%|█████████▍| 4008/4252 [00:50<00:03, 75.44batch/s]
    Training batches on cpu:  94%|█████████▍| 4016/4252 [00:50<00:03, 76.37batch/s]
    Training batches on cpu:  95%|█████████▍| 4024/4252 [00:50<00:03, 75.30batch/s]
    Training batches on cpu:  95%|█████████▍| 4033/4252 [00:50<00:02, 76.51batch/s]
    Training batches on cpu:  95%|█████████▌| 4041/4252 [00:51<00:02, 76.48batch/s]
    Training batches on cpu:  95%|█████████▌| 4049/4252 [00:51<00:02, 76.03batch/s]
    Training batches on cpu:  95%|█████████▌| 4057/4252 [00:51<00:02, 75.18batch/s]
    Training batches on cpu:  96%|█████████▌| 4065/4252 [00:51<00:02, 75.75batch/s]
    Training batches on cpu:  96%|█████████▌| 4073/4252 [00:51<00:02, 75.94batch/s]
    Training batches on cpu:  96%|█████████▌| 4081/4252 [00:51<00:02, 76.08batch/s]
    Training batches on cpu:  96%|█████████▌| 4089/4252 [00:51<00:02, 76.39batch/s]
    Training batches on cpu:  96%|█████████▋| 4097/4252 [00:51<00:02, 75.32batch/s]
    Training batches on cpu:  97%|█████████▋| 4105/4252 [00:51<00:01, 75.85batch/s]
    Training batches on cpu:  97%|█████████▋| 4113/4252 [00:51<00:01, 75.58batch/s]
    Training batches on cpu:  97%|█████████▋| 4121/4252 [00:52<00:01, 75.82batch/s]
    Training batches on cpu:  97%|█████████▋| 4129/4252 [00:52<00:01, 74.72batch/s]
    Training batches on cpu:  97%|█████████▋| 4138/4252 [00:52<00:01, 76.11batch/s]
    Training batches on cpu:  98%|█████████▊| 4146/4252 [00:52<00:01, 76.19batch/s]
    Training batches on cpu:  98%|█████████▊| 4154/4252 [00:52<00:01, 75.62batch/s]
    Training batches on cpu:  98%|█████████▊| 4162/4252 [00:52<00:01, 76.27batch/s]
    Training batches on cpu:  98%|█████████▊| 4171/4252 [00:52<00:01, 76.55batch/s]
    Training batches on cpu:  98%|█████████▊| 4179/4252 [00:52<00:00, 76.50batch/s]
    Training batches on cpu:  98%|█████████▊| 4187/4252 [00:52<00:00, 77.12batch/s]
    Training batches on cpu:  99%|█████████▊| 4195/4252 [00:53<00:00, 76.04batch/s]
    Training batches on cpu:  99%|█████████▉| 4203/4252 [00:53<00:00, 75.09batch/s]
    Training batches on cpu:  99%|█████████▉| 4211/4252 [00:53<00:00, 74.64batch/s]
    Training batches on cpu:  99%|█████████▉| 4219/4252 [00:53<00:00, 75.36batch/s]
    Training batches on cpu:  99%|█████████▉| 4227/4252 [00:53<00:00, 75.46batch/s]
    Training batches on cpu: 100%|█████████▉| 4235/4252 [00:53<00:00, 75.52batch/s]
    Training batches on cpu: 100%|█████████▉| 4243/4252 [00:53<00:00, 74.72batch/s]
    Training batches on cpu: 100%|█████████▉| 4251/4252 [00:53<00:00, 74.38batch/s]
    Training epochs on cpu:  50%|█████     | 1/2 [00:53<00:53, 53.97s/epoch, loss=0.754, prev_loss=nan]
    Training batches on cpu:   0%|          | 0/4252 [00:00<?, ?batch/s]
    Training batches on cpu:   0%|          | 6/4252 [00:00<01:14, 56.75batch/s]
    Training batches on cpu:   0%|          | 14/4252 [00:00<01:01, 68.65batch/s]
    Training batches on cpu:   1%|          | 22/4252 [00:00<00:58, 72.50batch/s]
    Training batches on cpu:   1%|          | 30/4252 [00:00<00:57, 72.94batch/s]
    Training batches on cpu:   1%|          | 38/4252 [00:00<00:56, 74.18batch/s]
    Training batches on cpu:   1%|          | 46/4252 [00:00<00:57, 72.59batch/s]
    Training batches on cpu:   1%|▏         | 54/4252 [00:00<00:57, 72.48batch/s]
    Training batches on cpu:   1%|▏         | 62/4252 [00:00<00:56, 73.69batch/s]
    Training batches on cpu:   2%|▏         | 70/4252 [00:00<00:56, 74.30batch/s]
    Training batches on cpu:   2%|▏         | 78/4252 [00:01<00:56, 74.51batch/s]
    Training batches on cpu:   2%|▏         | 86/4252 [00:01<00:55, 75.51batch/s]
    Training batches on cpu:   2%|▏         | 94/4252 [00:01<00:55, 74.49batch/s]
    Training batches on cpu:   2%|▏         | 102/4252 [00:01<00:55, 75.06batch/s]
    Training batches on cpu:   3%|▎         | 110/4252 [00:01<00:54, 76.32batch/s]
    Training batches on cpu:   3%|▎         | 118/4252 [00:01<00:53, 76.79batch/s]
    Training batches on cpu:   3%|▎         | 126/4252 [00:01<00:54, 76.01batch/s]
    Training batches on cpu:   3%|▎         | 134/4252 [00:01<00:54, 75.69batch/s]
    Training batches on cpu:   3%|▎         | 142/4252 [00:01<00:53, 76.34batch/s]
    Training batches on cpu:   4%|▎         | 150/4252 [00:02<00:53, 76.57batch/s]
    Training batches on cpu:   4%|▎         | 158/4252 [00:02<00:53, 76.52batch/s]
    Training batches on cpu:   4%|▍         | 166/4252 [00:02<00:54, 75.40batch/s]
    Training batches on cpu:   4%|▍         | 174/4252 [00:02<00:54, 75.06batch/s]
    Training batches on cpu:   4%|▍         | 182/4252 [00:02<00:54, 75.03batch/s]
    Training batches on cpu:   4%|▍         | 190/4252 [00:02<00:53, 75.65batch/s]
    Training batches on cpu:   5%|▍         | 198/4252 [00:02<00:52, 76.52batch/s]
    Training batches on cpu:   5%|▍         | 206/4252 [00:02<00:53, 76.05batch/s]
    Training batches on cpu:   5%|▌         | 214/4252 [00:02<00:53, 75.94batch/s]
    Training batches on cpu:   5%|▌         | 222/4252 [00:02<00:52, 76.95batch/s]
    Training batches on cpu:   5%|▌         | 230/4252 [00:03<00:52, 76.13batch/s]
    Training batches on cpu:   6%|▌         | 238/4252 [00:03<00:52, 76.42batch/s]
    Training batches on cpu:   6%|▌         | 246/4252 [00:03<00:51, 77.30batch/s]
    Training batches on cpu:   6%|▌         | 254/4252 [00:03<00:51, 77.70batch/s]
    Training batches on cpu:   6%|▌         | 262/4252 [00:03<00:52, 75.98batch/s]
    Training batches on cpu:   6%|▋         | 270/4252 [00:03<00:52, 75.25batch/s]
    Training batches on cpu:   7%|▋         | 278/4252 [00:03<00:53, 74.95batch/s]
    Training batches on cpu:   7%|▋         | 286/4252 [00:03<00:53, 74.54batch/s]
    Training batches on cpu:   7%|▋         | 294/4252 [00:03<00:52, 75.09batch/s]
    Training batches on cpu:   7%|▋         | 302/4252 [00:04<00:53, 74.01batch/s]
    Training batches on cpu:   7%|▋         | 310/4252 [00:04<00:53, 73.88batch/s]
    Training batches on cpu:   7%|▋         | 318/4252 [00:04<00:53, 74.21batch/s]
    Training batches on cpu:   8%|▊         | 326/4252 [00:04<00:53, 74.02batch/s]
    Training batches on cpu:   8%|▊         | 334/4252 [00:04<00:53, 73.08batch/s]
    Training batches on cpu:   8%|▊         | 342/4252 [00:04<00:53, 73.64batch/s]
    Training batches on cpu:   8%|▊         | 350/4252 [00:04<00:53, 73.22batch/s]
    Training batches on cpu:   8%|▊         | 358/4252 [00:04<00:52, 73.94batch/s]
    Training batches on cpu:   9%|▊         | 366/4252 [00:04<00:52, 73.43batch/s]
    Training batches on cpu:   9%|▉         | 374/4252 [00:05<00:52, 74.09batch/s]
    Training batches on cpu:   9%|▉         | 382/4252 [00:05<00:51, 74.56batch/s]
    Training batches on cpu:   9%|▉         | 390/4252 [00:05<00:52, 73.45batch/s]
    Training batches on cpu:   9%|▉         | 398/4252 [00:05<00:52, 73.90batch/s]
    Training batches on cpu:  10%|▉         | 406/4252 [00:05<00:51, 74.42batch/s]
    Training batches on cpu:  10%|▉         | 414/4252 [00:05<00:52, 73.76batch/s]
    Training batches on cpu:  10%|▉         | 422/4252 [00:05<00:52, 73.51batch/s]
    Training batches on cpu:  10%|█         | 430/4252 [00:05<00:51, 74.35batch/s]
    Training batches on cpu:  10%|█         | 438/4252 [00:05<00:50, 74.95batch/s]
    Training batches on cpu:  10%|█         | 446/4252 [00:05<00:52, 72.71batch/s]
    Training batches on cpu:  11%|█         | 454/4252 [00:06<00:53, 71.42batch/s]
    Training batches on cpu:  11%|█         | 462/4252 [00:06<00:52, 72.84batch/s]
    Training batches on cpu:  11%|█         | 470/4252 [00:06<00:51, 73.46batch/s]
    Training batches on cpu:  11%|█         | 478/4252 [00:06<00:50, 74.11batch/s]
    Training batches on cpu:  11%|█▏        | 486/4252 [00:06<00:51, 72.75batch/s]
    Training batches on cpu:  12%|█▏        | 494/4252 [00:06<00:51, 72.41batch/s]
    Training batches on cpu:  12%|█▏        | 502/4252 [00:06<00:51, 72.96batch/s]
    Training batches on cpu:  12%|█▏        | 510/4252 [00:06<00:51, 72.95batch/s]
    Training batches on cpu:  12%|█▏        | 518/4252 [00:06<00:51, 72.94batch/s]
    Training batches on cpu:  12%|█▏        | 526/4252 [00:07<00:50, 74.15batch/s]
    Training batches on cpu:  13%|█▎        | 534/4252 [00:07<00:50, 73.57batch/s]
    Training batches on cpu:  13%|█▎        | 542/4252 [00:07<00:50, 73.18batch/s]
    Training batches on cpu:  13%|█▎        | 550/4252 [00:07<00:50, 73.70batch/s]
    Training batches on cpu:  13%|█▎        | 558/4252 [00:07<00:50, 73.27batch/s]
    Training batches on cpu:  13%|█▎        | 566/4252 [00:07<00:50, 73.16batch/s]
    Training batches on cpu:  13%|█▎        | 574/4252 [00:07<00:50, 73.49batch/s]
    Training batches on cpu:  14%|█▎        | 582/4252 [00:07<00:50, 73.32batch/s]
    Training batches on cpu:  14%|█▍        | 590/4252 [00:07<00:50, 73.20batch/s]
    Training batches on cpu:  14%|█▍        | 598/4252 [00:08<00:50, 72.72batch/s]
    Training batches on cpu:  14%|█▍        | 606/4252 [00:08<00:50, 72.58batch/s]
    Training batches on cpu:  14%|█▍        | 614/4252 [00:08<00:49, 73.08batch/s]
    Training batches on cpu:  15%|█▍        | 622/4252 [00:08<00:49, 73.03batch/s]
    Training batches on cpu:  15%|█▍        | 630/4252 [00:08<00:49, 73.20batch/s]
    Training batches on cpu:  15%|█▌        | 638/4252 [00:08<00:48, 73.92batch/s]
    Training batches on cpu:  15%|█▌        | 646/4252 [00:08<00:49, 73.02batch/s]
    Training batches on cpu:  15%|█▌        | 654/4252 [00:08<00:49, 73.39batch/s]
    Training batches on cpu:  16%|█▌        | 662/4252 [00:08<00:49, 72.85batch/s]
    Training batches on cpu:  16%|█▌        | 670/4252 [00:09<00:49, 72.48batch/s]
    Training batches on cpu:  16%|█▌        | 678/4252 [00:09<00:49, 72.22batch/s]
    Training batches on cpu:  16%|█▌        | 686/4252 [00:09<00:48, 73.02batch/s]
    Training batches on cpu:  16%|█▋        | 694/4252 [00:09<00:48, 73.19batch/s]
    Training batches on cpu:  17%|█▋        | 702/4252 [00:09<00:48, 73.92batch/s]
    Training batches on cpu:  17%|█▋        | 710/4252 [00:09<00:48, 73.41batch/s]
    Training batches on cpu:  17%|█▋        | 718/4252 [00:09<00:48, 73.47batch/s]
    Training batches on cpu:  17%|█▋        | 726/4252 [00:09<00:47, 73.50batch/s]
    Training batches on cpu:  17%|█▋        | 734/4252 [00:09<00:47, 73.33batch/s]
    Training batches on cpu:  17%|█▋        | 742/4252 [00:10<00:48, 73.01batch/s]
    Training batches on cpu:  18%|█▊        | 750/4252 [00:10<00:48, 72.58batch/s]
    Training batches on cpu:  18%|█▊        | 758/4252 [00:10<00:48, 71.71batch/s]
    Training batches on cpu:  18%|█▊        | 766/4252 [00:10<00:48, 71.49batch/s]
    Training batches on cpu:  18%|█▊        | 774/4252 [00:10<00:48, 71.53batch/s]
    Training batches on cpu:  18%|█▊        | 782/4252 [00:10<00:47, 72.33batch/s]
    Training batches on cpu:  19%|█▊        | 790/4252 [00:10<00:48, 71.73batch/s]
    Training batches on cpu:  19%|█▉        | 798/4252 [00:10<00:48, 71.50batch/s]
    Training batches on cpu:  19%|█▉        | 806/4252 [00:10<00:48, 70.78batch/s]
    Training batches on cpu:  19%|█▉        | 814/4252 [00:11<00:48, 70.47batch/s]
    Training batches on cpu:  19%|█▉        | 822/4252 [00:11<00:47, 71.57batch/s]
    Training batches on cpu:  20%|█▉        | 830/4252 [00:11<00:47, 72.16batch/s]
    Training batches on cpu:  20%|█▉        | 838/4252 [00:11<00:47, 72.19batch/s]
    Training batches on cpu:  20%|█▉        | 846/4252 [00:11<00:47, 72.02batch/s]
    Training batches on cpu:  20%|██        | 854/4252 [00:11<00:46, 72.48batch/s]
    Training batches on cpu:  20%|██        | 862/4252 [00:11<00:46, 72.81batch/s]
    Training batches on cpu:  20%|██        | 870/4252 [00:11<00:46, 73.04batch/s]
    Training batches on cpu:  21%|██        | 878/4252 [00:11<00:45, 73.81batch/s]
    Training batches on cpu:  21%|██        | 886/4252 [00:12<00:45, 73.34batch/s]
    Training batches on cpu:  21%|██        | 894/4252 [00:12<00:45, 73.22batch/s]
    Training batches on cpu:  21%|██        | 902/4252 [00:12<00:45, 72.93batch/s]
    Training batches on cpu:  21%|██▏       | 910/4252 [00:12<00:45, 72.93batch/s]
    Training batches on cpu:  22%|██▏       | 918/4252 [00:12<00:45, 73.53batch/s]
    Training batches on cpu:  22%|██▏       | 926/4252 [00:12<00:45, 73.34batch/s]
    Training batches on cpu:  22%|██▏       | 934/4252 [00:12<00:45, 72.23batch/s]
    Training batches on cpu:  22%|██▏       | 942/4252 [00:12<00:46, 71.85batch/s]
    Training batches on cpu:  22%|██▏       | 950/4252 [00:12<00:46, 71.78batch/s]
    Training batches on cpu:  23%|██▎       | 958/4252 [00:13<00:46, 70.41batch/s]
    Training batches on cpu:  23%|██▎       | 966/4252 [00:13<00:46, 70.58batch/s]
    Training batches on cpu:  23%|██▎       | 974/4252 [00:13<00:46, 70.89batch/s]
    Training batches on cpu:  23%|██▎       | 982/4252 [00:13<00:45, 71.49batch/s]
    Training batches on cpu:  23%|██▎       | 990/4252 [00:13<00:45, 72.11batch/s]
    Training batches on cpu:  23%|██▎       | 998/4252 [00:13<00:45, 71.96batch/s]
    Training batches on cpu:  24%|██▎       | 1006/4252 [00:13<00:45, 71.66batch/s]
    Training batches on cpu:  24%|██▍       | 1014/4252 [00:13<00:45, 71.27batch/s]
    Training batches on cpu:  24%|██▍       | 1022/4252 [00:13<00:44, 72.34batch/s]
    Training batches on cpu:  24%|██▍       | 1030/4252 [00:14<00:45, 71.35batch/s]
    Training batches on cpu:  24%|██▍       | 1038/4252 [00:14<00:44, 71.62batch/s]
    Training batches on cpu:  25%|██▍       | 1046/4252 [00:14<00:44, 72.40batch/s]
    Training batches on cpu:  25%|██▍       | 1054/4252 [00:14<00:44, 72.55batch/s]
    Training batches on cpu:  25%|██▍       | 1062/4252 [00:14<00:44, 72.47batch/s]
    Training batches on cpu:  25%|██▌       | 1070/4252 [00:14<00:43, 72.41batch/s]
    Training batches on cpu:  25%|██▌       | 1078/4252 [00:14<00:43, 72.56batch/s]
    Training batches on cpu:  26%|██▌       | 1086/4252 [00:14<00:43, 72.28batch/s]
    Training batches on cpu:  26%|██▌       | 1094/4252 [00:14<00:43, 72.47batch/s]
    Training batches on cpu:  26%|██▌       | 1102/4252 [00:15<00:43, 72.80batch/s]
    Training batches on cpu:  26%|██▌       | 1110/4252 [00:15<00:43, 71.86batch/s]
    Training batches on cpu:  26%|██▋       | 1118/4252 [00:15<00:43, 71.79batch/s]
    Training batches on cpu:  26%|██▋       | 1126/4252 [00:15<00:43, 71.93batch/s]
    Training batches on cpu:  27%|██▋       | 1134/4252 [00:15<00:43, 71.84batch/s]
    Training batches on cpu:  27%|██▋       | 1142/4252 [00:15<00:43, 72.16batch/s]
    Training batches on cpu:  27%|██▋       | 1150/4252 [00:15<00:42, 72.39batch/s]
    Training batches on cpu:  27%|██▋       | 1158/4252 [00:15<00:42, 72.15batch/s]
    Training batches on cpu:  27%|██▋       | 1166/4252 [00:15<00:42, 72.19batch/s]
    Training batches on cpu:  28%|██▊       | 1174/4252 [00:16<00:43, 70.87batch/s]
    Training batches on cpu:  28%|██▊       | 1182/4252 [00:16<00:43, 70.72batch/s]
    Training batches on cpu:  28%|██▊       | 1190/4252 [00:16<00:43, 70.06batch/s]
    Training batches on cpu:  28%|██▊       | 1198/4252 [00:16<00:43, 70.15batch/s]
    Training batches on cpu:  28%|██▊       | 1206/4252 [00:16<00:42, 71.34batch/s]
    Training batches on cpu:  29%|██▊       | 1214/4252 [00:16<00:42, 72.19batch/s]
    Training batches on cpu:  29%|██▊       | 1222/4252 [00:16<00:41, 72.41batch/s]
    Training batches on cpu:  29%|██▉       | 1230/4252 [00:16<00:41, 71.98batch/s]
    Training batches on cpu:  29%|██▉       | 1238/4252 [00:16<00:41, 72.85batch/s]
    Training batches on cpu:  29%|██▉       | 1246/4252 [00:17<00:41, 72.67batch/s]
    Training batches on cpu:  29%|██▉       | 1254/4252 [00:17<00:41, 71.96batch/s]
    Training batches on cpu:  30%|██▉       | 1262/4252 [00:17<00:41, 71.48batch/s]
    Training batches on cpu:  30%|██▉       | 1270/4252 [00:17<00:41, 71.33batch/s]
    Training batches on cpu:  30%|███       | 1278/4252 [00:17<00:41, 71.80batch/s]
    Training batches on cpu:  30%|███       | 1286/4252 [00:17<00:41, 72.13batch/s]
    Training batches on cpu:  30%|███       | 1294/4252 [00:17<00:40, 72.37batch/s]
    Training batches on cpu:  31%|███       | 1302/4252 [00:17<00:40, 72.73batch/s]
    Training batches on cpu:  31%|███       | 1310/4252 [00:17<00:41, 70.67batch/s]
    Training batches on cpu:  31%|███       | 1318/4252 [00:18<00:41, 70.58batch/s]
    Training batches on cpu:  31%|███       | 1326/4252 [00:18<00:41, 71.26batch/s]
    Training batches on cpu:  31%|███▏      | 1334/4252 [00:18<00:40, 71.56batch/s]
    Training batches on cpu:  32%|███▏      | 1342/4252 [00:18<00:40, 71.96batch/s]
    Training batches on cpu:  32%|███▏      | 1350/4252 [00:18<00:40, 72.45batch/s]
    Training batches on cpu:  32%|███▏      | 1358/4252 [00:18<00:39, 72.39batch/s]
    Training batches on cpu:  32%|███▏      | 1366/4252 [00:18<00:40, 71.96batch/s]
    Training batches on cpu:  32%|███▏      | 1374/4252 [00:18<00:40, 70.91batch/s]
    Training batches on cpu:  33%|███▎      | 1382/4252 [00:18<00:40, 71.69batch/s]
    Training batches on cpu:  33%|███▎      | 1390/4252 [00:19<00:40, 71.29batch/s]
    Training batches on cpu:  33%|███▎      | 1398/4252 [00:19<00:40, 70.63batch/s]
    Training batches on cpu:  33%|███▎      | 1406/4252 [00:19<00:40, 70.37batch/s]
    Training batches on cpu:  33%|███▎      | 1414/4252 [00:19<00:39, 71.30batch/s]
    Training batches on cpu:  33%|███▎      | 1422/4252 [00:19<00:39, 70.83batch/s]
    Training batches on cpu:  34%|███▎      | 1430/4252 [00:19<00:40, 70.32batch/s]
    Training batches on cpu:  34%|███▍      | 1438/4252 [00:19<00:39, 70.70batch/s]
    Training batches on cpu:  34%|███▍      | 1446/4252 [00:19<00:39, 70.98batch/s]
    Training batches on cpu:  34%|███▍      | 1454/4252 [00:19<00:39, 71.36batch/s]
    Training batches on cpu:  34%|███▍      | 1462/4252 [00:20<00:39, 70.87batch/s]
    Training batches on cpu:  35%|███▍      | 1470/4252 [00:20<00:39, 69.98batch/s]
    Training batches on cpu:  35%|███▍      | 1478/4252 [00:20<00:39, 70.09batch/s]
    Training batches on cpu:  35%|███▍      | 1486/4252 [00:20<00:39, 70.73batch/s]
    Training batches on cpu:  35%|███▌      | 1494/4252 [00:20<00:38, 70.99batch/s]
    Training batches on cpu:  35%|███▌      | 1502/4252 [00:20<00:39, 70.25batch/s]
    Training batches on cpu:  36%|███▌      | 1510/4252 [00:20<00:39, 69.19batch/s]
    Training batches on cpu:  36%|███▌      | 1517/4252 [00:20<00:40, 68.17batch/s]
    Training batches on cpu:  36%|███▌      | 1525/4252 [00:20<00:39, 69.20batch/s]
    Training batches on cpu:  36%|███▌      | 1533/4252 [00:21<00:39, 69.55batch/s]
    Training batches on cpu:  36%|███▌      | 1540/4252 [00:21<00:39, 69.34batch/s]
    Training batches on cpu:  36%|███▋      | 1548/4252 [00:21<00:38, 70.23batch/s]
    Training batches on cpu:  37%|███▋      | 1556/4252 [00:21<00:38, 70.27batch/s]
    Training batches on cpu:  37%|███▋      | 1564/4252 [00:21<00:38, 70.49batch/s]
    Training batches on cpu:  37%|███▋      | 1572/4252 [00:21<00:37, 71.02batch/s]
    Training batches on cpu:  37%|███▋      | 1580/4252 [00:21<00:37, 71.58batch/s]
    Training batches on cpu:  37%|███▋      | 1588/4252 [00:21<00:37, 71.98batch/s]
    Training batches on cpu:  38%|███▊      | 1596/4252 [00:21<00:37, 71.29batch/s]
    Training batches on cpu:  38%|███▊      | 1604/4252 [00:22<00:37, 70.64batch/s]
    Training batches on cpu:  38%|███▊      | 1612/4252 [00:22<00:37, 70.37batch/s]
    Training batches on cpu:  38%|███▊      | 1620/4252 [00:22<00:37, 70.00batch/s]
    Training batches on cpu:  38%|███▊      | 1628/4252 [00:22<00:37, 69.20batch/s]
    Training batches on cpu:  38%|███▊      | 1636/4252 [00:22<00:37, 69.91batch/s]
    Training batches on cpu:  39%|███▊      | 1644/4252 [00:22<00:37, 70.23batch/s]
    Training batches on cpu:  39%|███▉      | 1652/4252 [00:22<00:36, 70.83batch/s]
    Training batches on cpu:  39%|███▉      | 1660/4252 [00:22<00:36, 70.87batch/s]
    Training batches on cpu:  39%|███▉      | 1668/4252 [00:22<00:36, 71.10batch/s]
    Training batches on cpu:  39%|███▉      | 1676/4252 [00:23<00:35, 71.83batch/s]
    Training batches on cpu:  40%|███▉      | 1684/4252 [00:23<00:36, 70.81batch/s]
    Training batches on cpu:  40%|███▉      | 1692/4252 [00:23<00:36, 70.87batch/s]
    Training batches on cpu:  40%|███▉      | 1700/4252 [00:23<00:36, 70.34batch/s]
    Training batches on cpu:  40%|████      | 1708/4252 [00:23<00:35, 70.72batch/s]
    Training batches on cpu:  40%|████      | 1716/4252 [00:23<00:35, 70.80batch/s]
    Training batches on cpu:  41%|████      | 1724/4252 [00:23<00:35, 70.86batch/s]
    Training batches on cpu:  41%|████      | 1732/4252 [00:23<00:35, 71.27batch/s]
    Training batches on cpu:  41%|████      | 1740/4252 [00:24<00:35, 71.37batch/s]
    Training batches on cpu:  41%|████      | 1748/4252 [00:24<00:35, 71.26batch/s]
    Training batches on cpu:  41%|████▏     | 1756/4252 [00:24<00:35, 70.06batch/s]
    Training batches on cpu:  41%|████▏     | 1764/4252 [00:24<00:35, 69.42batch/s]
    Training batches on cpu:  42%|████▏     | 1771/4252 [00:24<00:36, 68.88batch/s]
    Training batches on cpu:  42%|████▏     | 1779/4252 [00:24<00:35, 70.08batch/s]
    Training batches on cpu:  42%|████▏     | 1787/4252 [00:24<00:34, 72.29batch/s]
    Training batches on cpu:  42%|████▏     | 1795/4252 [00:24<00:34, 71.31batch/s]
    Training batches on cpu:  42%|████▏     | 1803/4252 [00:24<00:34, 71.59batch/s]
    Training batches on cpu:  43%|████▎     | 1811/4252 [00:25<00:33, 72.78batch/s]
    Training batches on cpu:  43%|████▎     | 1819/4252 [00:25<00:33, 73.42batch/s]
    Training batches on cpu:  43%|████▎     | 1827/4252 [00:25<00:33, 71.50batch/s]
    Training batches on cpu:  43%|████▎     | 1835/4252 [00:25<00:34, 70.59batch/s]
    Training batches on cpu:  43%|████▎     | 1843/4252 [00:25<00:34, 70.15batch/s]
    Training batches on cpu:  44%|████▎     | 1851/4252 [00:25<00:34, 70.03batch/s]
    Training batches on cpu:  44%|████▎     | 1859/4252 [00:25<00:33, 71.06batch/s]
    Training batches on cpu:  44%|████▍     | 1867/4252 [00:25<00:33, 71.04batch/s]
    Training batches on cpu:  44%|████▍     | 1875/4252 [00:25<00:33, 71.02batch/s]
    Training batches on cpu:  44%|████▍     | 1883/4252 [00:26<00:33, 70.27batch/s]
    Training batches on cpu:  44%|████▍     | 1891/4252 [00:26<00:33, 70.85batch/s]
    Training batches on cpu:  45%|████▍     | 1899/4252 [00:26<00:33, 70.71batch/s]
    Training batches on cpu:  45%|████▍     | 1907/4252 [00:26<00:33, 70.98batch/s]
    Training batches on cpu:  45%|████▌     | 1915/4252 [00:26<00:33, 70.61batch/s]
    Training batches on cpu:  45%|████▌     | 1923/4252 [00:26<00:32, 70.72batch/s]
    Training batches on cpu:  45%|████▌     | 1931/4252 [00:26<00:32, 70.61batch/s]
    Training batches on cpu:  46%|████▌     | 1939/4252 [00:26<00:32, 70.91batch/s]
    Training batches on cpu:  46%|████▌     | 1947/4252 [00:26<00:32, 70.93batch/s]
    Training batches on cpu:  46%|████▌     | 1955/4252 [00:27<00:32, 70.95batch/s]
    Training batches on cpu:  46%|████▌     | 1963/4252 [00:27<00:32, 70.96batch/s]
    Training batches on cpu:  46%|████▋     | 1971/4252 [00:27<00:32, 70.22batch/s]
    Training batches on cpu:  47%|████▋     | 1979/4252 [00:27<00:32, 71.01batch/s]
    Training batches on cpu:  47%|████▋     | 1987/4252 [00:27<00:31, 71.00batch/s]
    Training batches on cpu:  47%|████▋     | 1995/4252 [00:27<00:32, 70.25batch/s]
    Training batches on cpu:  47%|████▋     | 2003/4252 [00:27<00:32, 70.10batch/s]
    Training batches on cpu:  47%|████▋     | 2011/4252 [00:27<00:31, 70.36batch/s]
    Training batches on cpu:  47%|████▋     | 2019/4252 [00:27<00:31, 71.30batch/s]
    Training batches on cpu:  48%|████▊     | 2027/4252 [00:28<00:31, 70.09batch/s]
    Training batches on cpu:  48%|████▊     | 2035/4252 [00:28<00:31, 70.35batch/s]
    Training batches on cpu:  48%|████▊     | 2043/4252 [00:28<00:31, 69.26batch/s]
    Training batches on cpu:  48%|████▊     | 2051/4252 [00:28<00:31, 70.32batch/s]
    Training batches on cpu:  48%|████▊     | 2059/4252 [00:28<00:31, 70.52batch/s]
    Training batches on cpu:  49%|████▊     | 2067/4252 [00:28<00:31, 70.10batch/s]
    Training batches on cpu:  49%|████▉     | 2075/4252 [00:28<00:31, 70.18batch/s]
    Training batches on cpu:  49%|████▉     | 2083/4252 [00:28<00:31, 69.69batch/s]
    Training batches on cpu:  49%|████▉     | 2090/4252 [00:28<00:31, 69.63batch/s]
    Training batches on cpu:  49%|████▉     | 2097/4252 [00:29<00:30, 69.59batch/s]
    Training batches on cpu:  49%|████▉     | 2104/4252 [00:29<00:30, 69.56batch/s]
    Training batches on cpu:  50%|████▉     | 2111/4252 [00:29<00:30, 69.15batch/s]
    Training batches on cpu:  50%|████▉     | 2118/4252 [00:29<00:30, 68.85batch/s]
    Training batches on cpu:  50%|████▉     | 2125/4252 [00:29<00:30, 68.64batch/s]
    Training batches on cpu:  50%|█████     | 2133/4252 [00:29<00:30, 69.97batch/s]
    Training batches on cpu:  50%|█████     | 2140/4252 [00:29<00:30, 69.64batch/s]
    Training batches on cpu:  50%|█████     | 2147/4252 [00:29<00:30, 68.99batch/s]
    Training batches on cpu:  51%|█████     | 2155/4252 [00:29<00:30, 69.24batch/s]
    Training batches on cpu:  51%|█████     | 2163/4252 [00:30<00:30, 69.40batch/s]
    Training batches on cpu:  51%|█████     | 2171/4252 [00:30<00:29, 70.26batch/s]
    Training batches on cpu:  51%|█████     | 2179/4252 [00:30<00:29, 70.29batch/s]
    Training batches on cpu:  51%|█████▏    | 2187/4252 [00:30<00:29, 69.57batch/s]
    Training batches on cpu:  52%|█████▏    | 2195/4252 [00:30<00:29, 70.18batch/s]
    Training batches on cpu:  52%|█████▏    | 2203/4252 [00:30<00:29, 69.50batch/s]
    Training batches on cpu:  52%|█████▏    | 2210/4252 [00:30<00:29, 68.75batch/s]
    Training batches on cpu:  52%|█████▏    | 2217/4252 [00:30<00:29, 68.77batch/s]
    Training batches on cpu:  52%|█████▏    | 2224/4252 [00:30<00:29, 68.97batch/s]
    Training batches on cpu:  52%|█████▏    | 2231/4252 [00:30<00:29, 68.93batch/s]
    Training batches on cpu:  53%|█████▎    | 2239/4252 [00:31<00:28, 69.58batch/s]
    Training batches on cpu:  53%|█████▎    | 2247/4252 [00:31<00:28, 69.82batch/s]
    Training batches on cpu:  53%|█████▎    | 2254/4252 [00:31<00:28, 69.73batch/s]
    Training batches on cpu:  53%|█████▎    | 2262/4252 [00:31<00:28, 69.93batch/s]
    Training batches on cpu:  53%|█████▎    | 2269/4252 [00:31<00:28, 69.41batch/s]
    Training batches on cpu:  54%|█████▎    | 2276/4252 [00:31<00:28, 69.04batch/s]
    Training batches on cpu:  54%|█████▎    | 2283/4252 [00:31<00:28, 68.78batch/s]
    Training batches on cpu:  54%|█████▍    | 2290/4252 [00:31<00:28, 68.39batch/s]
    Training batches on cpu:  54%|█████▍    | 2298/4252 [00:31<00:28, 69.41batch/s]
    Training batches on cpu:  54%|█████▍    | 2306/4252 [00:32<00:27, 70.09batch/s]
    Training batches on cpu:  54%|█████▍    | 2314/4252 [00:32<00:27, 69.80batch/s]
    Training batches on cpu:  55%|█████▍    | 2322/4252 [00:32<00:27, 69.97batch/s]
    Training batches on cpu:  55%|█████▍    | 2329/4252 [00:32<00:27, 69.26batch/s]
    Training batches on cpu:  55%|█████▍    | 2336/4252 [00:32<00:27, 69.13batch/s]
    Training batches on cpu:  55%|█████▌    | 2343/4252 [00:32<00:27, 69.24batch/s]
    Training batches on cpu:  55%|█████▌    | 2350/4252 [00:32<00:27, 67.94batch/s]
    Training batches on cpu:  55%|█████▌    | 2358/4252 [00:32<00:27, 68.33batch/s]
    Training batches on cpu:  56%|█████▌    | 2365/4252 [00:32<00:27, 68.66batch/s]
    Training batches on cpu:  56%|█████▌    | 2372/4252 [00:33<00:27, 68.70batch/s]
    Training batches on cpu:  56%|█████▌    | 2379/4252 [00:33<00:27, 68.54batch/s]
    Training batches on cpu:  56%|█████▌    | 2387/4252 [00:33<00:26, 69.31batch/s]
    Training batches on cpu:  56%|█████▋    | 2394/4252 [00:33<00:27, 68.01batch/s]
    Training batches on cpu:  56%|█████▋    | 2402/4252 [00:33<00:26, 68.74batch/s]
    Training batches on cpu:  57%|█████▋    | 2409/4252 [00:33<00:27, 68.19batch/s]
    Training batches on cpu:  57%|█████▋    | 2416/4252 [00:33<00:26, 68.56batch/s]
    Training batches on cpu:  57%|█████▋    | 2423/4252 [00:33<00:26, 68.44batch/s]
    Training batches on cpu:  57%|█████▋    | 2430/4252 [00:33<00:26, 68.75batch/s]
    Training batches on cpu:  57%|█████▋    | 2437/4252 [00:33<00:26, 68.37batch/s]
    Training batches on cpu:  57%|█████▋    | 2444/4252 [00:34<00:26, 68.60batch/s]
    Training batches on cpu:  58%|█████▊    | 2451/4252 [00:34<00:26, 68.46batch/s]
    Training batches on cpu:  58%|█████▊    | 2458/4252 [00:34<00:26, 68.57batch/s]
    Training batches on cpu:  58%|█████▊    | 2465/4252 [00:34<00:26, 68.04batch/s]
    Training batches on cpu:  58%|█████▊    | 2472/4252 [00:34<00:26, 68.07batch/s]
    Training batches on cpu:  58%|█████▊    | 2479/4252 [00:34<00:26, 67.90batch/s]
    Training batches on cpu:  58%|█████▊    | 2486/4252 [00:34<00:25, 68.17batch/s]
    Training batches on cpu:  59%|█████▊    | 2493/4252 [00:34<00:25, 68.16batch/s]
    Training batches on cpu:  59%|█████▉    | 2500/4252 [00:34<00:25, 68.35batch/s]
    Training batches on cpu:  59%|█████▉    | 2507/4252 [00:35<00:25, 67.89batch/s]
    Training batches on cpu:  59%|█████▉    | 2514/4252 [00:35<00:25, 68.37batch/s]
    Training batches on cpu:  59%|█████▉    | 2521/4252 [00:35<00:25, 68.30batch/s]
    Training batches on cpu:  59%|█████▉    | 2529/4252 [00:35<00:24, 68.96batch/s]
    Training batches on cpu:  60%|█████▉    | 2536/4252 [00:35<00:25, 68.42batch/s]
    Training batches on cpu:  60%|█████▉    | 2543/4252 [00:35<00:25, 68.15batch/s]
    Training batches on cpu:  60%|█████▉    | 2551/4252 [00:35<00:24, 68.66batch/s]
    Training batches on cpu:  60%|██████    | 2558/4252 [00:35<00:24, 68.32batch/s]
    Training batches on cpu:  60%|██████    | 2566/4252 [00:35<00:24, 69.73batch/s]
    Training batches on cpu:  61%|██████    | 2574/4252 [00:35<00:24, 69.54batch/s]
    Training batches on cpu:  61%|██████    | 2581/4252 [00:36<00:24, 68.76batch/s]
    Training batches on cpu:  61%|██████    | 2589/4252 [00:36<00:24, 68.88batch/s]
    Training batches on cpu:  61%|██████    | 2596/4252 [00:36<00:24, 68.86batch/s]
    Training batches on cpu:  61%|██████    | 2604/4252 [00:36<00:23, 68.95batch/s]
    Training batches on cpu:  61%|██████▏   | 2611/4252 [00:36<00:23, 68.91batch/s]
    Training batches on cpu:  62%|██████▏   | 2619/4252 [00:36<00:23, 68.99batch/s]
    Training batches on cpu:  62%|██████▏   | 2626/4252 [00:36<00:23, 68.18batch/s]
    Training batches on cpu:  62%|██████▏   | 2633/4252 [00:36<00:23, 68.55batch/s]
    Training batches on cpu:  62%|██████▏   | 2640/4252 [00:36<00:23, 68.05batch/s]
    Training batches on cpu:  62%|██████▏   | 2648/4252 [00:37<00:23, 68.59batch/s]
    Training batches on cpu:  62%|██████▏   | 2655/4252 [00:37<00:23, 68.27batch/s]
    Training batches on cpu:  63%|██████▎   | 2663/4252 [00:37<00:22, 69.11batch/s]
    Training batches on cpu:  63%|██████▎   | 2670/4252 [00:37<00:22, 69.03batch/s]
    Training batches on cpu:  63%|██████▎   | 2678/4252 [00:37<00:22, 69.64batch/s]
    Training batches on cpu:  63%|██████▎   | 2686/4252 [00:37<00:22, 70.05batch/s]
    Training batches on cpu:  63%|██████▎   | 2694/4252 [00:37<00:22, 70.15batch/s]
    Training batches on cpu:  64%|██████▎   | 2702/4252 [00:37<00:22, 69.84batch/s]
    Training batches on cpu:  64%|██████▎   | 2709/4252 [00:37<00:22, 69.36batch/s]
    Training batches on cpu:  64%|██████▍   | 2717/4252 [00:38<00:22, 69.48batch/s]
    Training batches on cpu:  64%|██████▍   | 2724/4252 [00:38<00:22, 69.10batch/s]
    Training batches on cpu:  64%|██████▍   | 2732/4252 [00:38<00:21, 69.87batch/s]
    Training batches on cpu:  64%|██████▍   | 2740/4252 [00:38<00:21, 69.65batch/s]
    Training batches on cpu:  65%|██████▍   | 2747/4252 [00:38<00:22, 68.10batch/s]
    Training batches on cpu:  65%|██████▍   | 2754/4252 [00:38<00:22, 67.18batch/s]
    Training batches on cpu:  65%|██████▍   | 2761/4252 [00:38<00:22, 67.64batch/s]
    Training batches on cpu:  65%|██████▌   | 2768/4252 [00:38<00:22, 67.41batch/s]
    Training batches on cpu:  65%|██████▌   | 2775/4252 [00:38<00:21, 68.01batch/s]
    Training batches on cpu:  65%|██████▌   | 2782/4252 [00:39<00:21, 68.25batch/s]
    Training batches on cpu:  66%|██████▌   | 2789/4252 [00:39<00:21, 67.63batch/s]
    Training batches on cpu:  66%|██████▌   | 2796/4252 [00:39<00:21, 68.17batch/s]
    Training batches on cpu:  66%|██████▌   | 2803/4252 [00:39<00:21, 67.19batch/s]
    Training batches on cpu:  66%|██████▌   | 2810/4252 [00:39<00:21, 67.47batch/s]
    Training batches on cpu:  66%|██████▋   | 2817/4252 [00:39<00:21, 66.52batch/s]
    Training batches on cpu:  66%|██████▋   | 2825/4252 [00:39<00:21, 67.36batch/s]
    Training batches on cpu:  67%|██████▋   | 2832/4252 [00:39<00:21, 67.59batch/s]
    Training batches on cpu:  67%|██████▋   | 2840/4252 [00:39<00:20, 68.27batch/s]
    Training batches on cpu:  67%|██████▋   | 2847/4252 [00:39<00:20, 68.04batch/s]
    Training batches on cpu:  67%|██████▋   | 2854/4252 [00:40<00:20, 68.26batch/s]
    Training batches on cpu:  67%|██████▋   | 2861/4252 [00:40<00:20, 68.42batch/s]
    Training batches on cpu:  67%|██████▋   | 2869/4252 [00:40<00:19, 69.43batch/s]
    Training batches on cpu:  68%|██████▊   | 2876/4252 [00:40<00:20, 68.28batch/s]
    Training batches on cpu:  68%|██████▊   | 2883/4252 [00:40<00:20, 67.85batch/s]
    Training batches on cpu:  68%|██████▊   | 2890/4252 [00:40<00:20, 67.94batch/s]
    Training batches on cpu:  68%|██████▊   | 2897/4252 [00:40<00:19, 68.19batch/s]
    Training batches on cpu:  68%|██████▊   | 2904/4252 [00:40<00:19, 67.79batch/s]
    Training batches on cpu:  68%|██████▊   | 2912/4252 [00:40<00:19, 68.23batch/s]
    Training batches on cpu:  69%|██████▊   | 2919/4252 [00:41<00:19, 68.59batch/s]
    Training batches on cpu:  69%|██████▉   | 2926/4252 [00:41<00:19, 67.68batch/s]
    Training batches on cpu:  69%|██████▉   | 2933/4252 [00:41<00:19, 66.87batch/s]
    Training batches on cpu:  69%|██████▉   | 2940/4252 [00:41<00:19, 67.05batch/s]
    Training batches on cpu:  69%|██████▉   | 2947/4252 [00:41<00:19, 67.18batch/s]
    Training batches on cpu:  69%|██████▉   | 2954/4252 [00:41<00:19, 67.66batch/s]
    Training batches on cpu:  70%|██████▉   | 2961/4252 [00:41<00:19, 67.41batch/s]
    Training batches on cpu:  70%|██████▉   | 2968/4252 [00:41<00:19, 67.43batch/s]
    Training batches on cpu:  70%|██████▉   | 2975/4252 [00:41<00:18, 67.84batch/s]
    Training batches on cpu:  70%|███████   | 2983/4252 [00:41<00:18, 68.65batch/s]
    Training batches on cpu:  70%|███████   | 2990/4252 [00:42<00:18, 68.31batch/s]
    Training batches on cpu:  71%|███████   | 2998/4252 [00:42<00:18, 68.58batch/s]
    Training batches on cpu:  71%|███████   | 3005/4252 [00:42<00:18, 67.88batch/s]
    Training batches on cpu:  71%|███████   | 3013/4252 [00:42<00:18, 68.47batch/s]
    Training batches on cpu:  71%|███████   | 3020/4252 [00:42<00:17, 68.56batch/s]
    Training batches on cpu:  71%|███████   | 3027/4252 [00:42<00:18, 67.49batch/s]
    Training batches on cpu:  71%|███████▏  | 3034/4252 [00:42<00:18, 67.30batch/s]
    Training batches on cpu:  72%|███████▏  | 3041/4252 [00:42<00:17, 67.74batch/s]
    Training batches on cpu:  72%|███████▏  | 3049/4252 [00:42<00:17, 68.57batch/s]
    Training batches on cpu:  72%|███████▏  | 3056/4252 [00:43<00:17, 68.64batch/s]
    Training batches on cpu:  72%|███████▏  | 3063/4252 [00:43<00:17, 68.89batch/s]
    Training batches on cpu:  72%|███████▏  | 3071/4252 [00:43<00:16, 70.14batch/s]
    Training batches on cpu:  72%|███████▏  | 3079/4252 [00:43<00:17, 68.88batch/s]
    Training batches on cpu:  73%|███████▎  | 3086/4252 [00:43<00:17, 68.10batch/s]
    Training batches on cpu:  73%|███████▎  | 3093/4252 [00:43<00:17, 67.74batch/s]
    Training batches on cpu:  73%|███████▎  | 3100/4252 [00:43<00:16, 67.85batch/s]
    Training batches on cpu:  73%|███████▎  | 3107/4252 [00:43<00:16, 67.75batch/s]
    Training batches on cpu:  73%|███████▎  | 3115/4252 [00:43<00:16, 68.20batch/s]
    Training batches on cpu:  73%|███████▎  | 3122/4252 [00:44<00:16, 67.05batch/s]
    Training batches on cpu:  74%|███████▎  | 3130/4252 [00:44<00:16, 68.08batch/s]
    Training batches on cpu:  74%|███████▍  | 3137/4252 [00:44<00:16, 68.10batch/s]
    Training batches on cpu:  74%|███████▍  | 3145/4252 [00:44<00:16, 68.43batch/s]
    Training batches on cpu:  74%|███████▍  | 3152/4252 [00:44<00:16, 68.16batch/s]
    Training batches on cpu:  74%|███████▍  | 3159/4252 [00:44<00:16, 68.15batch/s]
    Training batches on cpu:  74%|███████▍  | 3166/4252 [00:44<00:16, 66.09batch/s]
    Training batches on cpu:  75%|███████▍  | 3173/4252 [00:44<00:16, 66.87batch/s]
    Training batches on cpu:  75%|███████▍  | 3180/4252 [00:44<00:16, 66.86batch/s]
    Training batches on cpu:  75%|███████▍  | 3188/4252 [00:44<00:15, 67.59batch/s]
    Training batches on cpu:  75%|███████▌  | 3195/4252 [00:45<00:15, 67.94batch/s]
    Training batches on cpu:  75%|███████▌  | 3202/4252 [00:45<00:15, 67.61batch/s]
    Training batches on cpu:  75%|███████▌  | 3209/4252 [00:45<00:15, 67.20batch/s]
    Training batches on cpu:  76%|███████▌  | 3216/4252 [00:45<00:15, 67.86batch/s]
    Training batches on cpu:  76%|███████▌  | 3223/4252 [00:45<00:15, 67.75batch/s]
    Training batches on cpu:  76%|███████▌  | 3230/4252 [00:45<00:15, 67.87batch/s]
    Training batches on cpu:  76%|███████▌  | 3237/4252 [00:45<00:14, 67.75batch/s]
    Training batches on cpu:  76%|███████▋  | 3244/4252 [00:45<00:15, 66.90batch/s]
    Training batches on cpu:  76%|███████▋  | 3252/4252 [00:45<00:14, 66.88batch/s]
    Training batches on cpu:  77%|███████▋  | 3259/4252 [00:46<00:15, 66.14batch/s]
    Training batches on cpu:  77%|███████▋  | 3267/4252 [00:46<00:14, 66.90batch/s]
    Training batches on cpu:  77%|███████▋  | 3274/4252 [00:46<00:14, 67.07batch/s]
    Training batches on cpu:  77%|███████▋  | 3281/4252 [00:46<00:14, 67.56batch/s]
    Training batches on cpu:  77%|███████▋  | 3288/4252 [00:46<00:14, 67.73batch/s]
    Training batches on cpu:  77%|███████▋  | 3295/4252 [00:46<00:14, 68.05batch/s]
    Training batches on cpu:  78%|███████▊  | 3302/4252 [00:46<00:14, 67.69batch/s]
    Training batches on cpu:  78%|███████▊  | 3309/4252 [00:46<00:13, 67.43batch/s]
    Training batches on cpu:  78%|███████▊  | 3316/4252 [00:46<00:14, 66.50batch/s]
    Training batches on cpu:  78%|███████▊  | 3324/4252 [00:47<00:13, 67.34batch/s]
    Training batches on cpu:  78%|███████▊  | 3331/4252 [00:47<00:13, 67.95batch/s]
    Training batches on cpu:  79%|███████▊  | 3338/4252 [00:47<00:13, 68.01batch/s]
    Training batches on cpu:  79%|███████▊  | 3345/4252 [00:47<00:13, 67.28batch/s]
    Training batches on cpu:  79%|███████▉  | 3352/4252 [00:47<00:13, 67.34batch/s]
    Training batches on cpu:  79%|███████▉  | 3359/4252 [00:47<00:13, 67.38batch/s]
    Training batches on cpu:  79%|███████▉  | 3366/4252 [00:47<00:13, 67.22batch/s]
    Training batches on cpu:  79%|███████▉  | 3373/4252 [00:47<00:13, 66.35batch/s]
    Training batches on cpu:  79%|███████▉  | 3380/4252 [00:47<00:13, 65.75batch/s]
    Training batches on cpu:  80%|███████▉  | 3387/4252 [00:47<00:13, 64.98batch/s]
    Training batches on cpu:  80%|███████▉  | 3394/4252 [00:48<00:13, 64.09batch/s]
    Training batches on cpu:  80%|███████▉  | 3401/4252 [00:48<00:13, 64.54batch/s]
    Training batches on cpu:  80%|████████  | 3408/4252 [00:48<00:12, 65.94batch/s]
    Training batches on cpu:  80%|████████  | 3415/4252 [00:48<00:12, 65.66batch/s]
    Training batches on cpu:  80%|████████  | 3422/4252 [00:48<00:12, 66.76batch/s]
    Training batches on cpu:  81%|████████  | 3429/4252 [00:48<00:12, 66.60batch/s]
    Training batches on cpu:  81%|████████  | 3436/4252 [00:48<00:12, 67.25batch/s]
    Training batches on cpu:  81%|████████  | 3443/4252 [00:48<00:12, 66.18batch/s]
    Training batches on cpu:  81%|████████  | 3451/4252 [00:48<00:11, 67.31batch/s]
    Training batches on cpu:  81%|████████▏ | 3458/4252 [00:49<00:11, 67.17batch/s]
    Training batches on cpu:  81%|████████▏ | 3465/4252 [00:49<00:11, 66.89batch/s]
    Training batches on cpu:  82%|████████▏ | 3472/4252 [00:49<00:11, 67.06batch/s]
    Training batches on cpu:  82%|████████▏ | 3479/4252 [00:49<00:11, 66.62batch/s]
    Training batches on cpu:  82%|████████▏ | 3486/4252 [00:49<00:11, 66.69batch/s]
    Training batches on cpu:  82%|████████▏ | 3493/4252 [00:49<00:11, 67.12batch/s]
    Training batches on cpu:  82%|████████▏ | 3500/4252 [00:49<00:11, 66.84batch/s]
    Training batches on cpu:  82%|████████▏ | 3507/4252 [00:49<00:11, 66.65batch/s]
    Training batches on cpu:  83%|████████▎ | 3514/4252 [00:49<00:11, 64.51batch/s]
    Training batches on cpu:  83%|████████▎ | 3521/4252 [00:49<00:11, 64.30batch/s]
    Training batches on cpu:  83%|████████▎ | 3528/4252 [00:50<00:11, 65.22batch/s]
    Training batches on cpu:  83%|████████▎ | 3535/4252 [00:50<00:10, 66.07batch/s]
    Training batches on cpu:  83%|████████▎ | 3542/4252 [00:50<00:10, 65.56batch/s]
    Training batches on cpu:  83%|████████▎ | 3549/4252 [00:50<00:10, 65.39batch/s]
    Training batches on cpu:  84%|████████▎ | 3556/4252 [00:50<00:10, 65.63batch/s]
    Training batches on cpu:  84%|████████▍ | 3563/4252 [00:50<00:10, 65.99batch/s]
    Training batches on cpu:  84%|████████▍ | 3570/4252 [00:50<00:10, 65.87batch/s]
    Training batches on cpu:  84%|████████▍ | 3577/4252 [00:50<00:10, 66.73batch/s]
    Training batches on cpu:  84%|████████▍ | 3584/4252 [00:50<00:10, 66.20batch/s]
    Training batches on cpu:  84%|████████▍ | 3591/4252 [00:51<00:09, 66.77batch/s]
    Training batches on cpu:  85%|████████▍ | 3598/4252 [00:51<00:09, 66.41batch/s]
    Training batches on cpu:  85%|████████▍ | 3605/4252 [00:51<00:09, 66.16batch/s]
    Training batches on cpu:  85%|████████▍ | 3612/4252 [00:51<00:09, 65.99batch/s]
    Training batches on cpu:  85%|████████▌ | 3619/4252 [00:51<00:09, 65.87batch/s]
    Training batches on cpu:  85%|████████▌ | 3626/4252 [00:51<00:09, 64.88batch/s]
    Training batches on cpu:  85%|████████▌ | 3633/4252 [00:51<00:09, 63.16batch/s]
    Training batches on cpu:  86%|████████▌ | 3640/4252 [00:51<00:09, 63.52batch/s]
    Training batches on cpu:  86%|████████▌ | 3647/4252 [00:51<00:09, 64.84batch/s]
    Training batches on cpu:  86%|████████▌ | 3654/4252 [00:52<00:09, 65.25batch/s]
    Training batches on cpu:  86%|████████▌ | 3661/4252 [00:52<00:09, 65.35batch/s]
    Training batches on cpu:  86%|████████▋ | 3668/4252 [00:52<00:08, 65.43batch/s]
    Training batches on cpu:  86%|████████▋ | 3675/4252 [00:52<00:08, 65.48batch/s]
    Training batches on cpu:  87%|████████▋ | 3682/4252 [00:52<00:08, 65.88batch/s]
    Training batches on cpu:  87%|████████▋ | 3689/4252 [00:52<00:08, 66.54batch/s]
    Training batches on cpu:  87%|████████▋ | 3696/4252 [00:52<00:08, 66.63batch/s]
    Training batches on cpu:  87%|████████▋ | 3703/4252 [00:52<00:08, 67.27batch/s]
    Training batches on cpu:  87%|████████▋ | 3710/4252 [00:52<00:08, 65.82batch/s]
    Training batches on cpu:  87%|████████▋ | 3717/4252 [00:52<00:08, 65.94batch/s]
    Training batches on cpu:  88%|████████▊ | 3724/4252 [00:53<00:08, 64.39batch/s]
    Training batches on cpu:  88%|████████▊ | 3731/4252 [00:53<00:08, 63.69batch/s]
    Training batches on cpu:  88%|████████▊ | 3738/4252 [00:53<00:07, 64.60batch/s]
    Training batches on cpu:  88%|████████▊ | 3745/4252 [00:53<00:07, 65.44batch/s]
    Training batches on cpu:  88%|████████▊ | 3752/4252 [00:53<00:07, 65.86batch/s]
    Training batches on cpu:  88%|████████▊ | 3759/4252 [00:53<00:07, 66.34batch/s]
    Training batches on cpu:  89%|████████▊ | 3766/4252 [00:53<00:07, 65.74batch/s]
    Training batches on cpu:  89%|████████▊ | 3773/4252 [00:53<00:07, 65.70batch/s]
    Training batches on cpu:  89%|████████▉ | 3780/4252 [00:53<00:07, 65.85batch/s]
    Training batches on cpu:  89%|████████▉ | 3787/4252 [00:54<00:07, 65.96batch/s]
    Training batches on cpu:  89%|████████▉ | 3794/4252 [00:54<00:06, 65.85batch/s]
    Training batches on cpu:  89%|████████▉ | 3801/4252 [00:54<00:06, 65.59batch/s]
    Training batches on cpu:  90%|████████▉ | 3808/4252 [00:54<00:06, 65.96batch/s]
    Training batches on cpu:  90%|████████▉ | 3815/4252 [00:54<00:06, 66.79batch/s]
    Training batches on cpu:  90%|████████▉ | 3822/4252 [00:54<00:06, 66.43batch/s]
    Training batches on cpu:  90%|█████████ | 3829/4252 [00:54<00:06, 66.74batch/s]
    Training batches on cpu:  90%|█████████ | 3836/4252 [00:54<00:06, 66.39batch/s]
    Training batches on cpu:  90%|█████████ | 3843/4252 [00:54<00:06, 65.97batch/s]
    Training batches on cpu:  91%|█████████ | 3850/4252 [00:54<00:06, 64.94batch/s]
    Training batches on cpu:  91%|█████████ | 3857/4252 [00:55<00:06, 65.68batch/s]
    Training batches on cpu:  91%|█████████ | 3864/4252 [00:55<00:05, 66.40batch/s]
    Training batches on cpu:  91%|█████████ | 3871/4252 [00:55<00:05, 67.11batch/s]
    Training batches on cpu:  91%|█████████ | 3878/4252 [00:55<00:05, 64.62batch/s]
    Training batches on cpu:  91%|█████████▏| 3885/4252 [00:55<00:05, 64.20batch/s]
    Training batches on cpu:  92%|█████████▏| 3892/4252 [00:55<00:05, 64.79batch/s]
    Training batches on cpu:  92%|█████████▏| 3899/4252 [00:55<00:05, 65.21batch/s]
    Training batches on cpu:  92%|█████████▏| 3906/4252 [00:55<00:05, 65.33batch/s]
    Training batches on cpu:  92%|█████████▏| 3913/4252 [00:55<00:05, 65.59batch/s]
    Training batches on cpu:  92%|█████████▏| 3920/4252 [00:56<00:05, 66.34batch/s]
    Training batches on cpu:  92%|█████████▏| 3927/4252 [00:56<00:04, 65.93batch/s]
    Training batches on cpu:  93%|█████████▎| 3934/4252 [00:56<00:04, 66.77batch/s]
    Training batches on cpu:  93%|█████████▎| 3941/4252 [00:56<00:04, 65.66batch/s]
    Training batches on cpu:  93%|█████████▎| 3948/4252 [00:56<00:04, 64.20batch/s]
    Training batches on cpu:  93%|█████████▎| 3955/4252 [00:56<00:04, 63.73batch/s]
    Training batches on cpu:  93%|█████████▎| 3962/4252 [00:56<00:04, 64.28batch/s]
    Training batches on cpu:  93%|█████████▎| 3969/4252 [00:56<00:04, 65.03batch/s]
    Training batches on cpu:  94%|█████████▎| 3976/4252 [00:56<00:04, 64.30batch/s]
    Training batches on cpu:  94%|█████████▎| 3983/4252 [00:57<00:04, 63.98batch/s]
    Training batches on cpu:  94%|█████████▍| 3990/4252 [00:57<00:04, 64.28batch/s]
    Training batches on cpu:  94%|█████████▍| 3997/4252 [00:57<00:03, 64.85batch/s]
    Training batches on cpu:  94%|█████████▍| 4004/4252 [00:57<00:03, 64.35batch/s]
    Training batches on cpu:  94%|█████████▍| 4011/4252 [00:57<00:03, 62.98batch/s]
    Training batches on cpu:  94%|█████████▍| 4018/4252 [00:57<00:03, 63.23batch/s]
    Training batches on cpu:  95%|█████████▍| 4025/4252 [00:57<00:03, 62.38batch/s]
    Training batches on cpu:  95%|█████████▍| 4032/4252 [00:57<00:03, 62.14batch/s]
    Training batches on cpu:  95%|█████████▍| 4039/4252 [00:57<00:03, 62.80batch/s]
    Training batches on cpu:  95%|█████████▌| 4046/4252 [00:58<00:03, 63.44batch/s]
    Training batches on cpu:  95%|█████████▌| 4053/4252 [00:58<00:03, 63.20batch/s]
    Training batches on cpu:  95%|█████████▌| 4060/4252 [00:58<00:03, 63.04batch/s]
    Training batches on cpu:  96%|█████████▌| 4067/4252 [00:58<00:02, 64.14batch/s]
    Training batches on cpu:  96%|█████████▌| 4074/4252 [00:58<00:02, 63.17batch/s]
    Training batches on cpu:  96%|█████████▌| 4081/4252 [00:58<00:02, 63.71batch/s]
    Training batches on cpu:  96%|█████████▌| 4088/4252 [00:58<00:02, 64.09batch/s]
    Training batches on cpu:  96%|█████████▋| 4095/4252 [00:58<00:02, 64.18batch/s]
    Training batches on cpu:  96%|█████████▋| 4102/4252 [00:58<00:02, 63.72batch/s]
    Training batches on cpu:  97%|█████████▋| 4109/4252 [00:59<00:02, 63.57batch/s]
    Training batches on cpu:  97%|█████████▋| 4116/4252 [00:59<00:02, 63.81batch/s]
    Training batches on cpu:  97%|█████████▋| 4123/4252 [00:59<00:02, 64.16batch/s]
    Training batches on cpu:  97%|█████████▋| 4130/4252 [00:59<00:01, 64.59batch/s]
    Training batches on cpu:  97%|█████████▋| 4137/4252 [00:59<00:01, 64.71batch/s]
    Training batches on cpu:  97%|█████████▋| 4144/4252 [00:59<00:01, 64.43batch/s]
    Training batches on cpu:  98%|█████████▊| 4151/4252 [00:59<00:01, 64.60batch/s]
    Training batches on cpu:  98%|█████████▊| 4158/4252 [00:59<00:01, 64.18batch/s]
    Training batches on cpu:  98%|█████████▊| 4165/4252 [00:59<00:01, 64.25batch/s]
    Training batches on cpu:  98%|█████████▊| 4172/4252 [00:59<00:01, 64.64batch/s]
    Training batches on cpu:  98%|█████████▊| 4179/4252 [01:00<00:01, 64.75batch/s]
    Training batches on cpu:  98%|█████████▊| 4186/4252 [01:00<00:01, 64.46batch/s]
    Training batches on cpu:  99%|█████████▊| 4193/4252 [01:00<00:00, 64.62batch/s]
    Training batches on cpu:  99%|█████████▉| 4200/4252 [01:00<00:00, 64.02batch/s]
    Training batches on cpu:  99%|█████████▉| 4207/4252 [01:00<00:00, 64.49batch/s]
    Training batches on cpu:  99%|█████████▉| 4214/4252 [01:00<00:00, 64.64batch/s]
    Training batches on cpu:  99%|█████████▉| 4221/4252 [01:00<00:00, 64.38batch/s]
    Training batches on cpu:  99%|█████████▉| 4228/4252 [01:00<00:00, 63.86batch/s]
    Training batches on cpu: 100%|█████████▉| 4235/4252 [01:00<00:00, 63.33batch/s]
    Training batches on cpu: 100%|█████████▉| 4242/4252 [01:01<00:00, 64.17batch/s]
    Training batches on cpu: 100%|█████████▉| 4249/4252 [01:01<00:00, 64.59batch/s]
    Training epochs on cpu: 100%|██████████| 2/2 [01:55<00:00, 57.69s/epoch, loss=0.289, prev_loss=0.754]
    You're trying to map triples with 9 entities and 0 relations that are not in the training set. These triples will be excluded from the mapping.
    In total 9 from 17535 triples were filtered out
    Evaluating on cpu:   0%|          | 0.00/20.4k [00:00<?, ?triple/s]Encountered tensors on device_types={'cpu'} while only ['cuda'] are considered safe for automatic memory utilization maximization. This may lead to undocumented crashes (but can be safe, too).
    Evaluating on cpu:   0%|          | 0.00/20.4k [00:00<?, ?triple/s]C:\\Users\\sQwiz\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pykeen\\utils.py:537: RuntimeWarning: overflow encountered in scalar add
      return sum(
    Evaluating on cpu: 100%|██████████| 20.4k/20.4k [14:49<00:00, 23.0triple/s]
    hits@1:  0.047, hits@3:  0.105, hits@10:  0.194, и MRR:  0.097
    """